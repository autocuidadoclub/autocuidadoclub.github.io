<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AutoCuidado Home ‚Ä¢ Cat√°logo ESAL</title>
  <link rel="stylesheet" href="../styles.css" />
  <style>
    /* Global Styles for the Page (Simplified) */
    .catalog-container {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1rem;
      text-align: center;
    }
    .catalog-title {
      font-size: 2rem;
      color: #002b5c; /* your blue color */
      margin-bottom: 1rem;
    }
    .catalog-description {
      font-size: 1.1rem;
      color: #444;
      margin-bottom: 1.5rem;
    }
    .catalog-buttons {
      margin-bottom: 2rem;
    }
    .catalog-buttons a {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      margin: 0 0.5rem;
      background-color: #ff6600; /* your orange accent */
      color: white;
      border-radius: 4px;
      text-decoration: none;
      font-weight: bold;
      transition: background-color 0.3s;
    }
    .catalog-buttons a:hover {
      background-color: #e65c00;
    }
    .catalog-embed {
      width: 100%;
      height: 700px;
      border: none;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 2rem;
    }
    /* Styles for the Order Box */
    .box {
      border: 1px solid #ddd;
      padding: 20px;
      margin: 20px auto;
      max-width: 500px; /* Constrain the form width */
      border-radius: 8px;
      text-align: left;
    }
    .box h4 {
        border-bottom: 1px solid #eee;
        padding-bottom: 5px;
        margin-top: 20px;
        margin-bottom: 10px;
        color: #002b5c;
    }
    .box label {
        display: block;
        margin-top: 10px;
        font-weight: bold;
    }
    .box input[type="number"], .box input[type="text"], .box select {
        width: 100%;
        padding: 8px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }
    .box .btn {
        width: 100%;
        padding: 15px;
        margin-top: 20px;
        background-color: #4CAF50; /* Green WhatsApp color */
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 1.1rem;
        cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <nav>
      </nav>
  </header>

  <div class="catalog-container">
    <h1 class="catalog-title">Cat√°logo AutoCuidado Home ‚Ä¢ ESAL</h1>
    <p class="catalog-description">
      Descubre nuestra l√≠nea de productos de limpieza, desinfectantes, jabones, repelentes y m√°s.
      Todo lo que necesitas para el cuidado del hogar con la calidad ESAL.
    </p>
    <div class="catalog-buttons">
      <a href="/esalcatalog.pdf" target="_blank" download>üì• Descargar PDF</a>
      <a href="/">‚Üê Volver a AutoCuidado Club</a>
    </div>
    <iframe
      src="/esalcatalog.pdf"
      class="catalog-embed"
      allowfullscreen
    ></iframe>

  <div class="box">
    <h2>üìã Pedido R√°pido ESAL - AutoCuidado Home</h2>
    <p class="catalog-description">Selecciona la cantidad de cada producto y presentaci√≥n para calcular tu total al instante.</p>

    <div class="order-table-container">
        <table>
            <thead>
                <tr>
                    <th>Producto y Presentaci√≥n</th>
                    <th class="text-center">Precio Unitario</th>
                    <th class="text-center">Cantidad</th>
                </tr>
            </thead>
            <tbody id="product-inputs-container">
                </tbody>
        </table>
    </div>
    
    <div class="summary-and-payment">
        <h3>Total: $<span id="totalAmount">0.00</span></h3>
        <p id="promoMessage" style="color: green; font-weight: bold;"></p>

        <label for="paymentMethod">M√©todo de Pago:</label>
        <select id="paymentMethod" required>
            <option value="" disabled selected>Selecciona un m√©todo</option>
            <option value="Efectivo contra entrega">Efectivo contra entrega</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Bitcoin">Bitcoin</option>
            <option value="Banco Agr√≠cola Tasa Cero">Banco Agr√≠cola Tasa Cero (desde $50)</option>
        </select>
    </div>

    <div class="delivery-info">
        <h3>Datos de Entrega</h3>
        <label for="name">Nombre de quien recibe:</label>
        <input type="text" id="name" required>

        <label for="municipality">Municipio:</label>
        <input type="text" id="municipality" placeholder="Ej: Santa Ana, San Miguel" required>
        
        <label for="location">Ubicaci√≥n exacta para entrega:</label>
        <input type="text" id="location" placeholder="Ej: Calle Principal, pasaje, casa #15" required>
    </div>

    <button class="btn" onclick="sendOrder()">Enviar Pedido por WhatsApp</button>
</div>

<style>
    .order-table-container {
        overflow-x: auto;
        margin-bottom: 20px;
    }
    .order-table-container table {
        width: 100%;
        border-collapse: collapse;
    }
    .order-table-container th, .order-table-container td {
        padding: 10px;
        border: 1px solid #eee;
        text-align: left;
    }
    .order-table-container thead th {
        background-color: #f0f0f0;
        font-weight: bold;
        color: #002b5c;
    }
    .product-group-header {
        background-color: #e6f7ff; /* Light blue background for category headers */
        font-weight: bold;
        color: #002b5c;
    }
    .text-center {
        text-align: center;
        width: 100px;
    }
    .product-qty-input {
        width: 60px;
        text-align: center;
        padding: 5px;
        border-radius: 4px;
        border: 1px solid #ccc;
    }
    .summary-and-payment, .delivery-info {
        margin-top: 25px;
        padding-top: 15px;
        border-top: 1px dashed #ccc;
    }
    .delivery-info input, .summary-and-payment select {
        margin-bottom: 15px;
    }
</style>
  <footer>
    </footer>


  <div id="cta-install-bar" style="display:none;">
      </div>
  
  <div id="feedbackModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
      </div>
  
  <button id="reopen-cta-btn" style="display: none; position: fixed; bottom: 20px; right: 20px; /* ... rest of your styles ... */">
      üì≤ Abrir men√∫
  </button>

<script>
    // --- ESAL PRODUCT DATA (Sourced from the catalog) ---
    // (Ensure you paste your complete ESAL_PRODUCTS object here)
    const ESAL_PRODUCTS = {
        "Alcohol Gel": [
            { id: "ag_galon_mango", size: "Gal√≥n", scent: "Mango", price: 13.50 },
            { id: "ag_500ml_sinfrag", size: "500 mL", scent: "Sin Fragancia", price: 4.50 },
            { id: "ag_30ml_sandia", size: "30 mL", scent: "Sand√≠a", price: 1.00 }
            // ... all other Alcohol Gel presentations
        ],
        "Desinfectante": [
            { id: "dd_galon_verde", size: "Gal√≥n (Uso Directo)", scent: "Manzana Verde", price: 3.25 },
            { id: "dc_galon_lavanda", size: "Gal√≥n (Concentrado)", scent: "Lavanda", price: 4.00 }
            // ... all other Desinfectante presentations
        ],
        "Jab√≥n L√≠quido": [
            { id: "jl_galon_chicle", size: "Gal√≥n", scent: "Chicle", price: 4.00 },
            { id: "jl_500ml_cereza", size: "500 mL", scent: "Cereza", price: 1.75 }
            // ... all other Jab√≥n L√≠quido presentations
        ],
        "Lej√≠a y Otros": [
            { id: "lejia_6", size: "Lej√≠a 6% Gal√≥n", scent: "N/A", price: 3.00 },
            { id: "repelente_120ml", size: "Repelente 120 mL", scent: "Citronela", price: 3.00 }
        ]
    };
    
    // --- Dynamic Form Generation ---
    (function generateFormTable() {
        const container = document.getElementById('product-inputs-container');
        let html = '';

        for (const category in ESAL_PRODUCTS) {
            // 1. Category Header Row
            html += `<tr class="product-group-header">
                        <td colspan="3">${category}</td>
                     </tr>`;

            // 2. Product Rows
            ESAL_PRODUCTS[category].forEach(product => {
                const scentDisplay = product.scent === 'N/A' ? '' : ` (${product.scent})`;
                const labelText = `${product.size}${scentDisplay}`;
                
                html += `<tr>
                            <td>${labelText}</td>
                            <td class="text-center">$${product.price.toFixed(2)}</td>
                            <td class="text-center">
                                <input 
                                    type="number" 
                                    class="product-qty-input"
                                    id="${product.id}" 
                                    min="0" 
                                    value="0" 
                                    oninput="updateTotal()" 
                                    data-price="${product.price.toFixed(2)}"
                                    data-name="${category}: ${labelText}"
                                >
                            </td>
                        </tr>`;
            });
        }
        container.innerHTML = html;
    })();

    // --- Dynamic Total Calculation Function ---
    function updateTotal() {
        let total = 0;
        // Select only the input fields within the table body
        const inputs = document.querySelectorAll('#product-inputs-container input[type="number"]');

        inputs.forEach(input => {
            const qty = parseInt(input.value) || 0;
            const price = parseFloat(input.getAttribute('data-price'));
            total += qty * price;
        });

        document.getElementById("totalAmount").textContent = total.toFixed(2);

        const promo = document.getElementById("promoMessage");
        promo.textContent = total >= 50 ? "‚úÖ ¬°Tu pedido aplica para Tasa Cero Banco Agr√≠cola!" : "";
    }

    // --- Dynamic WhatsApp Order Function ---
    function sendOrder() {
        const inputs = document.querySelectorAll('#product-inputs-container input[type="number"]');
        let totalQty = 0;
        let orderDetails = "";

        inputs.forEach(input => {
            const qty = parseInt(input.value) || 0;
            if (qty > 0) {
                const name = input.getAttribute('data-name');
                orderDetails += `* ${qty}x ${name}\n`;
                totalQty += qty;
            }
        });

        const location = document.getElementById("location").value.trim();
        const municipality = document.getElementById("municipality").value.trim();
        const name = document.getElementById("name").value.trim();
        const paymentMethod = document.getElementById("paymentMethod").value;
        const total = document.getElementById("totalAmount").textContent;
        const whatsappNumber = "50375704428"; // Use your actual WhatsApp number

        // Basic validation
        if (totalQty === 0) {
            alert("‚ö†Ô∏è Por favor, selecciona al menos un producto.");
            return;
        }
        if (!location || !municipality || !name || !paymentMethod) {
            alert("‚ö†Ô∏è Por favor, completa todos los campos de entrega y selecciona un M√©todo de Pago.");
            return;
        }


        let message = `*ORDEN DE PRODUCTOS ESAL - ${new Date().toLocaleDateString('es-SV')}*\n\n`;
        message += `*PRODUCTOS DETALLE:*\n${orderDetails}\n`;
        message += `*TOTAL ESTIMADO: $${total}*\n`;
        message += `*M√âTODO DE PAGO:* ${paymentMethod}\n\n`;
        message += `*DATOS DE ENTREGA:*\nNombre: ${name}\nMunicipio: ${municipality}\nUbicaci√≥n: ${location}`;

        window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, "_blank");
    }
</script>
  </body>
</html>
