<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AutoCuidado Home ‚Ä¢ Cat√°logo ESAL</title>
    <link rel="stylesheet" href="../styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Global Styles for the Page (Simplified) */
        .catalog-container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1rem;
            text-align: center;
        }
        .catalog-title {
            font-size: 2rem;
            color: #002b5c; /* your blue color */
            margin-bottom: 1rem;
        }
        .catalog-description {
            font-size: 1.1rem;
            color: #444;
            margin-bottom: 1.5rem;
        }
        .catalog-buttons {
            margin-bottom: 2rem;
        }
        .catalog-buttons a {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            margin: 0 0.5rem;
            background-color: #ff6600; /* your orange accent */
            color: white;
            border-radius: 4px;
            text-decoration: none;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .catalog-buttons a:hover {
            background-color: #e65c00;
        }
        .catalog-embed {
            width: 100%;
            height: 700px;
            border: none;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        /* Styles for the Order Box */
        .box {
            border: 1px solid #ddd;
            padding: 20px;
            margin: 20px auto;
            max-width: 500px; /* Constrain the form width */
            border-radius: 8px;
            text-align: left;
        }
        .box h4 {
            border-bottom: 1px solid #eee;
            padding-bottom: 5px;
            margin-top: 20px;
            margin-bottom: 10px;
            color: #002b5c;
        }
        .box label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        .box input[type="number"], .box input[type="text"], .box select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .box .btn {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background-color: #4CAF50; /* Green WhatsApp color */
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
        }
        /* New/Updated styles for tables */
        .order-table-container {
            overflow-x: auto;
            margin-bottom: 30px; 
        }
        .order-table-container table {
            width: 100%;
            border-collapse: collapse;
        }
        .order-table-container th, .order-table-container td {
            padding: 10px 5px;
            border: 1px solid #eee;
            text-align: left;
        }
        .order-table-container thead th {
            background-color: #f0f0f0;
            font-weight: bold;
            color: #002b5c;
            font-size: 0.85em; 
            vertical-align: middle;
            text-align: center;
        }
        .product-group-header {
            background-color: #e6f7ff;
            font-weight: bold;
            color: #002b5c;
            text-align: center;
        }
        .text-center {
            text-align: center;
        }
        .product-qty-input {
            width: 60px;
            text-align: center;
            padding: 5px;
            border-radius: 4px;
            border: 1px solid #ccc;
            font-size: 0.9em;
        }
        .matrix-scent-cell {
            font-weight: 500;
            color: #333;
            width: 150px;
            text-align: left !important;
        }
        .matrix-size-cell {
            width: 90px;
            text-align: center;
        }
        
        /* --- NEW STYLES FOR INFO ROW --- */
        .info-row {
            display: flex;
            flex-direction: column; /* Default stack on small screens */
            gap: 20px;
            margin: 30px auto;
            max-width: 900px;
        }

        .about-card {
            background-color: #f7f7f7;
            padding: 25px;
            border-radius: 8px;
            border: 1px solid #eee;
            text-align: left;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .about-card h3 {
            color: #002b5c;
            margin-top: 0;
            border-bottom: 2px solid #ff6600;
            display: inline-block;
            padding-bottom: 5px;
            margin-bottom: 10px;
        }

        .shipping-banner {
            background-color: #e6f7ff; /* Light blue/teal background */
            color: #002b5c;
            padding: 15px 20px;
            border-radius: 8px;
            border: 1px solid #cceeff;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            text-align: left;
        }
        .shipping-banner strong {
            color: #ff6600;
        }

        @media (min-width: 768px) {
            .info-row {
                flex-direction: row; /* Two columns on larger screens */
                align-items: stretch;
            }
            .about-card {
                flex: 2; /* Give more space to the about card */
            }
            .shipping-banner {
                flex: 1; /* Give less space to the banner */
                align-self: center; /* Center vertically with the card */
            }
        }
        /* --- END NEW STYLES --- */
        
        /* Other existing styles... */
        .product-group-header {
            background-color: #e6f7ff;
            font-weight: bold;
            color: #002b5c;
            text-align: center;
        }
        /* ... (rest of your existing styles) ... */
    </style>


    <title>AutoCuidado Club - Inicio</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">

    <script>
    (function(w, d) {
        w.PushEngage = w.PushEngage || [];
        w._peq = w._peq || [];
        PushEngage.push(['init', {
            appId: '2f304881-8eee-4a7a-a487-6f231bd85ec7'
        }]);

        var e = d.createElement('script');
        e.src = 'https://clientcdn.pushengage.com/sdks/pushengage-web-sdk.js';
        e.async = true;
        e.type = 'text/javascript';
        d.head.appendChild(e);
    })(window, document);
    </script>
        
</head>

<body>
    <nav class="navbar">
        <li class="has-dropdown">
            <a href="/ecosystem" class="divisiones-badge"> CONOCE NUESTRAS DIVISIONES</a>
        </li>
        </ul>
        <div class="logo-container">
            <img src="logo.jpg" alt="AutoCuidado Club Logo" class="logo">
        </div>
    </nav>

    

<header style="background: linear-gradient(135deg, #002F6C, #003B80); padding: 60px 20px; text-align: center; border-bottom: 4px solid #FF6600;">
    
    <div class="header-text">
        <h1 style="color: white; font-size: 2.5em; margin-bottom: 15px;">Bienvenido a AutoCuidado HOME</h1>
        <p style="color: white; font-size: 1.2em;">Tu vales oro.
            Cuidamos tu entorno, tu salud y tu productividad, porque autocuidarte tambi√©n es cuidar tu hogar.</p>
    </div>
</header>


<body>
    <header>
        <nav>
        </nav>
    </header>

    <div class="catalog-container">
        <h1 class="catalog-title">Cat√°logo AutoCuidado Home ‚Ä¢ ESAL</h1>
        <p class="catalog-description">
            Descubre nuestra l√≠nea de productos de limpieza, desinfectantes, jabones, repelentes y m√°s.
            Todo lo que necesitas para el cuidado del hogar con la calidad ESAL.
        </p>
        <div class="catalog-buttons">
            <a href="/esalcatalog.pdf" target="_blank" download>üì• Descargar PDF</a>
            <a href="/">‚Üê Volver a AutoCuidado Club</a>
        </div>
        <iframe
            src="/esalcatalog.pdf"
            class="catalog-embed"
            allowfullscreen
        ></iframe>

        <div class="info-row">
            <div class="about-card">
                <h3>Qui√©nes somos</h3>
                <p><strong>Somos fabricantes de productos de limpieza</strong>, adapt√°ndonos a las especificaciones de nuestros clientes. Cada f√≥rmula, empaque y presentaci√≥n se dise√±a para cumplir tus requisitos: calidad profesional hecha en <strong>El Salvador</strong>.</p>
                <ul style="margin:.5rem 0 0 1rem; text-align: left;">
                    <li>Formulaciones personalizadas</li>
                    <li>Empaque y etiquetado seg√∫n necesidad</li>
                    <li>Control de calidad y registro sanitario</li>
                </ul>
            </div>

            <div class="shipping-banner" aria-live="polite">
                <i class="fas fa-truck" style="font-size:26px;"></i>
                <div style="text-align:left;">
                    <div style="font-weight:800;">Env√≠o gratis desde <strong>US$15.00</strong></div>
                    <div style="font-size:.95rem; opacity:.95;">Cobertura: <strong>Todo El Salvador</strong></div>
                </div>
            </div>
        </div>
        <div class="box">
    <h2>üìã Pedido R√°pido ESAL - AutoCuidado Home</h2>
    <p class="catalog-description">Selecciona la cantidad de cada producto y presentaci√≥n para calcular tu total al instante.</p>

    <div id="product-inputs-container">
    </div>
    <div class="summary-and-payment">
        <h3>Total: $<span id="totalAmount">0.00</span></h3>
        <p id="promoMessage" style="color: green; font-weight: bold;"></p>

        <label for="paymentMethod">M√©todo de Pago:</label>
        <select id="paymentMethod" required>
            <option value="" disabled selected>Selecciona un m√©todo</option>
            <option value="Transferencia bancaria">Transferencia bancaria</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Bitcoin">Bitcoin</option>
            <option value="Banco Agr√≠cola Tasa Cero">Banco Agr√≠cola Tasa Cero (desde $50)</option>
        </select>
    </div>

    <div class="delivery-info">
        <h3>Datos de Entrega</h3>
        <label for="name">Nombre de quien recibe:</label>
        <input type="text" id="name" required>

        <label for="municipality">Municipio:</label>
        <input type="text" id="municipality" placeholder="Ej: Santa Ana, San Miguel" required>
        
        <label for="location">Ubicaci√≥n exacta para entrega:</label>
        <input type="text" id="location" placeholder="Ej: Calle Principal, pasaje, casa #15" required>
    </div>

    <button class="btn" onclick="sendOrder()">Enviar Pedido por WhatsApp</button>
</div>
    </div>

    
    
    <footer>
    </footer>


    <div id="cta-install-bar" style="display:none;">
        </div>
    
    <div id="feedbackModal" style="display:none;
        position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
        </div>
    
    <button id="reopen-cta-btn" style="display: none;
        position: fixed; bottom: 20px; right: 20px; /* ... rest of your styles ... */">
        üì≤ Abrir men√∫
    </button>

<script>
    // --- DATOS DE PRODUCTOS ESAL (Completo) ---
    const ESAL_PRODUCTS = {
        "Alcohol Gel": [
            { id: "ag_galon_mango", size: "Gal√≥n", scent: "Mango", price: 13.50 },
            { id: "ag_galon_manzana", size: "Gal√≥n", scent: "Manzana Verde", price: 13.50 },
            { id: "ag_galon_maracuya", size: "Gal√≥n", scent: "Maracuy√°", price: 13.50 },
            { id: "ag_galon_sandia", size: "Gal√≥n", scent: "Sand√≠a", price: 13.50 },
            { id: "ag_galon_sinfrag", size: "Gal√≥n", scent: "Sin Fragancia", price: 13.50 },
            { id: "ag_500ml_mango", size: "500 mL", scent: "Mango", price: 4.50 },
            { id: "ag_500ml_manzana", size: "500 mL", scent: "Manzana Verde", price: 4.50 },
            { id: "ag_500ml_maracuya", size: "500 mL", scent: "Maracuy√°", price: 4.50 },
            { id: "ag_500ml_sandia", size: "500 mL", scent: "Sand√≠a", price: 4.50 },
            { id: "ag_500ml_sinfrag", size: "500 mL", scent: "Sin Fragancia", price: 4.50 },
            { id: "ag_120ml_mango", size: "120 mL", scent: "Mango", price: 1.75 },
            { id: "ag_120ml_manzana", size: "120 mL", scent: "Manzana Verde", price: 1.75 },
            { id: "ag_120ml_maracuya", size: "120 mL", scent: "Maracuy√°", price: 1.75 },
            { id: "ag_120ml_sandia", size: "120 mL", scent: "Sand√≠a", price: 1.75 },
            { id: "ag_120ml_sinfrag", size: "120 mL", scent: "Sin Fragancia", price: 1.75 },
            { id: "ag_30ml_mango", size: "30 mL", scent: "Mango", price: 1.00 },
            { id: "ag_30ml_manzana", size: "30 mL", scent: "Manzana Verde", price: 1.00 },
            { id: "ag_30ml_maracuya", size: "30 mL", scent: "Maracuy√°", price: 1.00 },
            { id: "ag_30ml_sandia", size: "30 mL", scent: "Sand√≠a", price: 1.00 },
            { id: "ag_30ml_sinfrag", size: "30 mL", scent: "Sin Fragancia", price: 1.00 },
            { id: "ag_30ml_silicon_sin", size: "30 mL", scent: "Sin Fragancia (Sin Silic√≥n)", price: 1.00 }
        ],
        "Alcohol L√≠quido": [
            { id: "al_galon_90", size: "Gal√≥n", scent: "90%", price: 12.00, display: "Gal√≥n 90%" },
            { id: "al_galon_70", size: "Gal√≥n", scent: "70%", price: 10.50, display: "Gal√≥n 70%" },
            { id: "al_spray_70", size: "120 mL Spray", scent: "70%", price: 1.75, display: "120 mL Spray 70%" }
        ],
        "Desinfectante Uso Directo (Piso)": [
            { id: "dd_galon_verde", size: "Gal√≥n", scent: "Manzana Verde", price: 3.25 },
            { id: "dd_galon_sin", size: "Gal√≥n", scent: "Sin Fragancia", price: 3.25 },
            { id: "dd_galon_lavanda", size: "Gal√≥n", scent: "Lavanda", price: 3.25 },
            { id: "dd_galon_maracuya", size: "Gal√≥n", scent: "Maracuy√°", price: 3.25 },
            { id: "dd_galon_limon", size: "Gal√≥n", scent: "Lim√≥n", price: 3.25 },
            { id: "dd_galon_citronela", size: "Gal√≥n", scent: "Citronela", price: 3.25 }
        ],
        "Desinfectante Concentrado (Piso)": [
            { id: "dc_galon_verde", size: "Gal√≥n", scent: "Manzana Verde", price: 4.00 },
            { id: "dc_galon_sin", size: "Gal√≥n", scent: "Sin Fragancia", price: 4.00 },
            { id: "dc_galon_lavanda", size: "Gal√≥n", scent: "Lavanda", price: 4.00 },
            { id: "dc_galon_maracuya", size: "Gal√≥n", scent: "Maracuy√°", price: 4.00 },
            { id: "dc_galon_limon", size: "Gal√≥n", scent: "Lim√≥n", price: 4.00 },
            { id: "dc_galon_citronela", size: "Gal√≥n", scent: "Citronela", price: 4.00 }
        ],
        "Lej√≠a": [
            { id: "lejia_4", size: "Gal√≥n", scent: "4%", price: 2.50, display: "Gal√≥n 4%" },
            { id: "lejia_6", size: "Gal√≥n", scent: "6%", price: 3.00, display: "Gal√≥n 6%" }
        ],
        "Jab√≥n L√≠quido para Manos": [
            { id: "jl_galon_verde", size: "Gal√≥n", scent: "Manzana Verde", price: 4.00 },
            { id: "jl_galon_cereza", size: "Gal√≥n", scent: "Cereza", price: 4.00 },
            { id: "jl_galon_fresa", size: "Gal√≥n", scent: "Fresa", price: 4.00 },
            { id: "jl_galon_durazno", size: "Gal√≥n", scent: "Durazno", price: 4.00 },
            { id: "jl_galon_chicle", size: "Gal√≥n", scent: "Chicle", price: 4.00 },
            { id: "jl_500ml_verde", size: "500 mL", scent: "Manzana Verde", price: 1.75 },
            { id: "jl_500ml_cereza", size: "500 mL", scent: "Cereza", price: 1.75 },
            { id: "jl_500ml_fresa", size: "500 mL", scent: "Fresa", price: 1.75 },
            { id: "jl_500ml_durazno", size: "500 mL", scent: "Durazno", price: 1.75 },
            { id: "jl_500ml_chicle", size: "500 mL", scent: "Chicle", price: 1.75 }
        ],
        "Repelente de Insectos": [
            { id: "repelente_120ml", size: "120 mL Spray", scent: "Citronela", price: 3.00, display: "120 mL Spray Citronela" }
        ]
    };
    const matrixCategories = ["Alcohol Gel", "Jab√≥n L√≠quido para Manos"];

    // --- Funciones Auxiliares para Generar HTML de la Tabla ---

    function generateInput(product, category) {
        // Genera el input de cantidad con data-price y data-name
        const productName = `${category}: ${product.size} (${product.scent})`;
        const displayPrice = product.price.toFixed(2);

        return product
            ?
            `<input 
                type="number" 
                class="product-qty-input"
                id="${product.id}" 
                min="0" 
                value="0" 
                oninput="updateTotal()" 
                data-price="${displayPrice}"
                data-name="${productName} ($${displayPrice})"
            >`
            : '';
    }

    function generateMatrixCategoryHtml(category, products) {
        const sizes = category === "Alcohol Gel" 
            ? ["Gal√≥n", "500 mL", "120 mL", "30 mL"] 
            : ["Gal√≥n", "500 mL"];
        // Usar un Set para obtener solo aromas √∫nicos
        const scents = [...new Set(products.map(p => p.scent))].filter(s => s !== "Sin Fragancia (Sin Silic√≥n)").sort();
        // Mapear productos por aroma y tama√±o para acceso r√°pido
        const productMap = {};
        products.forEach(p => {
            if (!productMap[p.scent]) productMap[p.scent] = {};
            productMap[p.scent][p.size] = p;
        });
        
        // **START ACCORDION WRAPPER (This is still using the non-accordion style from the file) **
        let html = `<div class="order-table-container">
            <table>
                <thead>
                    <tr class="product-group-header"><th colspan="${sizes.length + 1}">üß¥ ${category}</th></tr>
                    <tr>
                        <th class="matrix-scent-cell">Aroma/Fragancia</th>`;
        // **END ACCORDION WRAPPER**
        
        sizes.forEach(size => {
            // Obtener el precio base para mostrarlo en el encabezado de la columna
            const exampleProduct = products.find(p => p.size === size);
            const priceText = exampleProduct ? `($${exampleProduct.price.toFixed(2)})` : '';
            html += `<th class="matrix-size-cell">${size}<br>${priceText}</th>`;
        });
        html += `</tr></thead><tbody>`;

        // Generar filas por aroma
        scents.forEach(scent => {
            html += `<tr><td class="matrix-scent-cell">${scent}</td>`;
            sizes.forEach(size => {
                const product = productMap[scent] ? productMap[scent][size] : null;
                const content = product ? generateInput(product, category) : '‚Äî';
                html += `<td class="matrix-size-cell">${content}</td>`;
            });
            html += `</tr>`;
        });
        // Caso especial: 30 mL Sin Silic√≥n (solo en Alcohol Gel)
        if (category === "Alcohol Gel") {
            const specialProduct = products.find(p => p.scent === "Sin Fragancia (Sin Silic√≥n)");
            if (specialProduct) {
                const content = generateInput(specialProduct, category);
                html += `<tr>
                    <td class="matrix-scent-cell">${specialProduct.scent}</td>
                    <td>‚Äî</td><td>‚Äî</td><td>‚Äî</td>
                    <td class="matrix-size-cell">${content}</td>
                </tr>`;
            }
        }

        html += `</tbody></table></div>`; 
        return html;
    }

    function generateVerticalCategoryHtml(category, products) {
        // Usado para Alcohol L√≠quido, Desinfectante, Lej√≠a y Repelente
        let html = `<div class="order-table-container">
            <table>
                <thead>
                    <tr class="product-group-header"><th colspan="3">üß¥ ${category}</th></tr>
                    <tr>
                        <th>Producto y Presentaci√≥n</th>
                        <th class="text-center">Precio Unitario</th>
                        <th class="text-center">Cantidad</th>
                    </tr>
                </thead>
                <tbody>`;
        
        products.forEach(product => {
            const labelText = product.display || `${product.size} (${product.scent})`;
            const content = generateInput(product, category);

            html += `<tr>
                        <td>${labelText}</td>
                        <td class="text-center">$${product.price.toFixed(2)}</td>
                        <td class="text-center">${content}</td>
                    </tr>`;
        });
        html += `</tbody></table></div>`;
        return html;
    }

    // --- Funci√≥n Principal de Generaci√≥n ---
    function initializeProductForm() {
        const container = document.getElementById('product-inputs-container');
        let fullHtml = '';

        for (const category in ESAL_PRODUCTS) {
            const products = ESAL_PRODUCTS[category];
            if (matrixCategories.includes(category)) {
                fullHtml += generateMatrixCategoryHtml(category, products);
            } else {
                fullHtml += generateVerticalCategoryHtml(category, products);
            }
        }
        container.innerHTML = fullHtml;
        updateTotal();
        // Asegura que el total inicial sea 0.00
    }

    // Ejecuta la funci√≥n cuando el DOM se haya cargado.
    window.addEventListener('load', initializeProductForm);


    // --- Funciones de L√≥gica (ACTUALIZADA LA L√ìGICA DE PROMOCIONES) ---

    function updateTotal() {
        let total = 0;
        // Selecciona todos los inputs de cantidad en el contenedor
        const inputs = document.querySelectorAll('#product-inputs-container input[type="number"]');
        inputs.forEach(input => {
            const qty = parseInt(input.value) || 0;
            const price = parseFloat(input.getAttribute('data-price'));
            total += qty * price;
        });
        document.getElementById("totalAmount").textContent = total.toFixed(2);

        const promo = document.getElementById("promoMessage");
        promo.textContent = ""; // Clear existing messages

        // Free shipping message if total >= $15.00 and less than $50.00
        if (total >= 15.00 && total < 50.00) {
            promo.innerHTML = "üöö <strong>¬°Env√≠o gratis en este pedido!</strong>";
        }

        // Both messages if total >= $50.00
        if (total >= 50.00) {
            promo.innerHTML = `
                ‚úÖ <strong>¬°Aplica para Tasa Cero Banco Agr√≠cola!</strong><br>
                üöö <strong>¬°Env√≠o gratis en este pedido!</strong>
            `;
        }
    }

    function sendOrder() {
        const inputs = document.querySelectorAll('#product-inputs-container input[type="number"]');
        let totalQty = 0;
        let orderDetails = "";

        inputs.forEach(input => {
            const qty = parseInt(input.value) || 0;
            if (qty > 0) {
                const name = input.getAttribute('data-name');
                orderDetails += `* ${qty}x ${name}\n`;
                totalQty += qty;
            }
        });
        const location = document.getElementById("location").value.trim();
        const municipality = document.getElementById("municipality").value.trim();
        const name = document.getElementById("name").value.trim();
        const paymentMethod = document.getElementById("paymentMethod").value;
        const total = document.getElementById("totalAmount").textContent;
        const whatsappNumber = "50375704428";

        // Validaci√≥n
        if (totalQty === 0) {
            alert("‚ö†Ô∏è Por favor, selecciona al menos un producto.");
            return;
        }
        if (!location || !municipality || !name || paymentMethod === "") {
            alert("‚ö†Ô∏è Por favor, completa todos los campos de entrega y selecciona un M√©todo de Pago.");
            return;
        }

        let message = `*ORDEN DE PRODUCTOS ESAL - ${new Date().toLocaleDateString('es-SV')}*\n\n`;
        message += `*PRODUCTOS DETALLE:*\n${orderDetails}\n`;
        message += `*TOTAL ESTIMADO: $${total}*\n`;
        message += `*M√âTODO DE PAGO:* ${paymentMethod}\n\n`;
        message += `*DATOS DE ENTREGA:*\nNombre: ${name}\nMunicipio: ${municipality}\nUbicaci√≥n: ${location}`;

        window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`, "_blank");
    }

    // Las funciones de PWA/Modal deben ir aqu√≠ si las quieres mantener:
    let deferredPrompt = null;
    window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    document.getElementById('how-to-install-btn').style.display = 'inline-block';
    });
    document.getElementById('how-to-install-btn').addEventListener('click', async () => {
    const isIos = /iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());
    const isAndroid = /android/.test(navigator.userAgent.toLowerCase());

    if (deferredPrompt) {
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        if (choiceResult.outcome === 'accepted') {
        console.log('‚úÖ User accepted the install prompt');
        } else {
        console.log('‚ùå User dismissed the install prompt');
        }
        deferredPrompt = null;
    } else if (isIos) {
        alert("üì≤ En iPhone, toca el bot√≥n de compartir en Safari y selecciona 'Agregar a pantalla de inicio'.");
    } else if (isAndroid) {
        alert("üì≤ En Android, abr√≠ el men√∫ de Chrome (‚ãÆ) y seleccion√° 'Agregar a pantalla de inicio'.");
    } else {
        alert("‚ö†Ô∏è Instalaci√≥n no disponible autom√°ticamente en este dispositivo. Pod√©s usar Chrome o Edge para instalar.");
    }
    });

    function openFeedbackModal() {
        document.getElementById('feedbackModal').style.display = 'flex';
        document.getElementById('feedbackText').focus();
    }

    function closeFeedbackModal() {
        document.getElementById('feedbackModal').style.display = 'none';
        document.getElementById('voiceFeedbackForm').reset();
        document.getElementById('feedbackLoader').style.display = 'none';
    }

    function startVoiceInput() {
        if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
        alert("Tu navegador no soporta reconocimiento de voz.");
        return;
        }

        const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'es-ES';
        const feedbackText = document.getElementById('feedbackText');
        feedbackText.placeholder = "üéôÔ∏è Escuchando...";
        feedbackText.style.border = "2px solid orange";
        recognition.onresult = (event) => {
        const result = event.results[0][0].transcript;
        feedbackText.value += (feedbackText.value ? ' ' : '') + result;
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
        };

        recognition.onerror = (event) => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
        alert("Error de voz: " + event.error);
        };
        recognition.onend = () => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
        };

        recognition.start();
    }

    document.getElementById('reopen-cta-btn').addEventListener('click', () => {
    const ctaBar = document.getElementById('cta-install-bar');
    const reopenBtn = document.getElementById('reopen-cta-btn');

    ctaBar.style.display = 'block';
    ctaBar.style.opacity = '1';
    ctaBar.style.transform = 'translateY(0)';
    reopenBtn.style.display = 'none';
    });
    document.getElementById('voiceFeedbackForm').onsubmit = function (e) {
        e.preventDefault();
        document.getElementById('feedbackLoader').style.display = 'block';
        fetch("https://formsubmit.co/ajax/info@autocuidadoclub.com", {
        method: "POST",
        body: new FormData(this)
        })
        .then(res => res.json())
        .then(data => {
        document.getElementById('feedbackLoader').style.display = 'none';
        if (data.success) {
            alert("¬°Gracias por tu opini√≥n!");
            closeFeedbackModal();
        } else {
            alert("Error al enviar. Intenta de nuevo.");
        }
        })
        .catch(() => {
        document.getElementById('feedbackLoader').style.display = 'none';
        alert("Hubo un problema al enviar el mensaje.");
        });
    };

    function closeCtaInstallBar() {
    const ctaBar = document.getElementById('cta-install-bar');
    const reopenBtn = document.getElementById('reopen-cta-btn');
    // Animaci√≥n suave antes de ocultarlo
    ctaBar.style.opacity = '0';
    ctaBar.style.transform = 'translateY(100%)';
    setTimeout(() => {
        ctaBar.style.display = 'none';
        reopenBtn.style.display = 'block';
        
        // Animaci√≥n de aparici√≥n para el bot√≥n de reabrir
        setTimeout(() => {
            reopenBtn.style.opacity = '1';
            reopenBtn.style.transform = 'translateY(0)';
        }, 50);

    }, 300);
    // Coincide con la duraci√≥n de la transici√≥n CSS
    }
</script>

        
<div style="background-color: #003893; color: white; padding: 20px; border-radius: 12px 12px 0 0;">
    <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap;">
        <img src="/flag-sv.png" alt="Bandera El Salvador" style="height: 60px; margin-right: 20px; border-radius: 6px; box-shadow: 0 0 6px rgba(0,0,0,0.3);">
        <div style="text-align: left; max-width: 300px;">
            <p style="margin: 0; font-size: 18px; font-weight: bold;">
                Esta app es m√°s que tecnolog√≠a.
            </p>
            <p style="margin: 5px 0 0; font-size: 16px;">
                Es una forma distinta de cuidar lo que importa.
            </p>
        </div>
    </div>
    <p style="text-align: center; margin-top: 20px; font-size: 16px;">
        <span style="color: #FFA500; font-weight: bold;">AutoCuidado Club</span> ‚Äî Hecha con visi√≥n.
        Hecha con orgullo en <strong>El Salvador.</strong>
    </p>
</div>
        
        <footer>
            <p>&copy;
                2025 AutoCuidado Club - Todos los derechos reservados.</p>
                   
        <div class="social-container" style="text-align: center; margin-top: 20px;">
        <p><strong>S√≠guenos en nuestras redes sociales</strong></p>
        <div class="social-buttons">
            <a href="https://www.instagram.com/esal_sv/?hl=en" target="_blank" class="social-button" style="color: #E1306C;">
                <i class="fab fa-instagram fa-3x"></i>
            </a>
            <a href="https://www.facebook.com/esalsv" target="_blank" class="social-button" style="color: #1877F2;">
                <i class="fab fa-facebook-f fa-3x"></i>
            </a>
            </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>

        
    </footer>

        <div id="cta-install-bar" style="display:none;">
            <div class="cta-message">
    ¬øQuer√©s contactarnos, dejarnos tu opini√≥n o instalar la app?
    <strong>Todo lo ten√©s aqu√≠.</strong>
    </div>

        <button onclick="openFeedbackModal()">üìù D√©janos tu opini√≥n</button>
        <a href="contacto.html">üí¨ Cont√°cta con nuestro staff</a>
        <button id="how-to-install-btn">üì≤ Instal√° nuestra APP</button>
        <button onclick="closeCtaInstallBar()" class="close-btn">‚ùå Cerrar</button>

        </div>
    </div>

    <div id="feedbackModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:white; padding:20px; border-radius:10px; width:90%; max-width:400px; position:relative;">
        
        
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
        <h3 style="margin: 0;">Tu opini√≥n sobre AutoCuidado Club</h3>
        <button onclick="closeFeedbackModal()" style="
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #ff0000;
        font-weight: bold;
        ">‚ùå</button>
    </div>

    <form id="voiceFeedbackForm">
        <input type="hidden" name="_subject" value="Feedback (Fase Family & Friends) - AutoCuidado Club">
        <input type="hidden" name="_cc" value="info@autocuidadoclub.com">
        <textarea id="feedbackText" name="message" rows="5" placeholder="Habla o escribe tu mensaje..." style="width:100%;
        margin-bottom:10px; resize:vertical;" required></textarea>
        <input type="email" name="email" placeholder="Tu correo (opcional)" style="width:100%;
        margin-bottom:10px;">
        <div style="display:flex;
        justify-content:space-between;">
        <button type="button" onclick="startVoiceInput()" style="background-color: #ff6600; color: white; border: none; padding: 10px 20px;
        border-radius: 8px; font-weight: bold;">üé§ Hablar</button>
        <button type="submit" style="background-color: #003893; color: white; border: none;
        padding: 10px 20px; border-radius: 8px; font-weight: bold;">Enviar</button>
        </div>
    </form>

    <div id="feedbackLoader" style="display:none;
        margin-top:10px; text-align:center;">
        <img src="loading.gif" alt="Cargando..." style="width:80px;">
    </div>

    </div>
    </div>


    <button id="reopen-cta-btn" style="
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #ff9800;
    color: white;
    border: none;
    padding: 10px 16px;
    border-radius: 12px;
    font-weight: bold;
    font-size: 13px;
    cursor: pointer;
    z-index: 9999;
    opacity: 0;
    max-width: 180px;
    width: auto;
    white-space: nowrap;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    transition: opacity 0.3s ease, transform 0.3s ease;
    ">
    üì≤ Abrir men√∫
    </button>
</body>
</html>
