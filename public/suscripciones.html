<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AutoCuidado Club - Tu servicio experto de mantenimiento personalizado para vehículos en El Salvador. Sin talleres. Sin filas. Sin excusas.">

    <title>Registro en AutoCuidado Club</title>
    <link rel="stylesheet" href="styles.css">

    <!-- Force Load env.js to Prevent Caching Issues -->
    <script src="env.js?v=1.0"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-messaging-compat.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            console.log("✅ DOM fully loaded!");

            if (typeof window._env_ === "undefined" || !window._env_.FIREBASE_API_KEY) {
                console.error("❌ Error: Firebase env.js no cargado.");
                alert("❌ Firebase no está inicializado. Revisa env.js.");
                return;
            }

            const firebaseConfig = {
                apiKey: window._env_.FIREBASE_API_KEY,
                authDomain: window._env_.FIREBASE_AUTH_DOMAIN,
                projectId: window._env_.FIREBASE_PROJECT_ID,
                storageBucket: window._env_.FIREBASE_STORAGE_BUCKET,
                messagingSenderId: window._env_.FIREBASE_MESSAGING_SENDER_ID,
                appId: window._env_.FIREBASE_APP_ID,
                measurementId: window._env_.FIREBASE_MEASUREMENT_ID
            };

            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
                console.log("✅ Firebase inicializado correctamente");
            }

            const auth = firebase.auth();
            const db = firebase.firestore();
            const messaging = firebase.messaging();
            let selectedPlanType = null;

            const registrationContainer = document.getElementById("registration-container");
            const planButtons = document.querySelectorAll(".plan-button");

           planButtons.forEach(button => {
    button.addEventListener("click", function () {
        selectedPlanType = this.getAttribute("data-plan");
        updateVehicleFields(selectedPlanType);
        registrationContainer.style.display = "block";

        // Delay inteligente para asegurar render correcto
        setTimeout(() => {
            registrationContainer.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }, isMobileDevice() ? 400 : 100);

        console.log(`✅ Plan seleccionado: ${selectedPlanType}`);
    });
});


            document.getElementById("registerForm").addEventListener("submit", registerUser);

          function registerUser(event) {
    event.preventDefault();

    const loader = document.getElementById("loader");
    loader.style.display = "flex"; // ⏳ Show loading

    if (!selectedPlanType) {
        alert("❌ Debes seleccionar un plan antes de registrarte.");
        loader.style.display = "none";
        return;
    }

    const name = document.getElementById("name").value.trim();
    const email = document.getElementById("email").value.trim();
    const phone = document.getElementById("phone").value.trim();
    const password = document.getElementById("password").value.trim();
    const department = document.getElementById("department").value;
    const municipality = document.getElementById("municipality").value;
    const selectedDay = document.getElementById("selectedDay").value;
    const selectedTime = document.getElementById("selectedTime").value;
    const referredBy = document.getElementById("referredBy") ? document.getElementById("referredBy").value.trim() : "";

    const vehicles = [];
    document.querySelectorAll(".vehicle-entry").forEach(entry => {
        vehicles.push({
            plate: entry.querySelector(".plate").value || "",
            model: entry.querySelector(".model").value || "",
            brand: entry.querySelector(".brand").value || "",
            year: entry.querySelector(".year").value || "",
            inspectionDates: []  // 🛡️ Empty array for future inspections
        });
    });

    if (!name || !email || !phone || !password || !department || !municipality || !selectedDay || !selectedTime) {
        alert("❌ Todos los campos son obligatorios.");
        loader.style.display = "none";
        return;
    }

    auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
            const userId = userCredential.user.uid;
            const paymentDate = new Date();
            const nextPaymentDate = new Date();
            nextPaymentDate.setMonth(paymentDate.getMonth() + 1);

            const userData = {
                uid: userId,
                name,
                email,
                phone,
                planType: selectedPlanType,
                department,
                municipality,
                registrationDate: firebase.firestore.Timestamp.now(),
                lastUpgradeDate: firebase.firestore.Timestamp.now(),
                schedule: {
                    day: selectedDay,
                    time: selectedTime
                },
                paymentDate: firebase.firestore.Timestamp.fromDate(paymentDate),
                nextPaymentDate: firebase.firestore.Timestamp.fromDate(nextPaymentDate),
                paymentStatus: "Pending",
                subscriptionStatus: "active",
                monthsPaid: 0,
                vehicles,
                freeRescheduleClaimed: false,

                loyaltyCycle: 0,
                lastLoyaltyReset: firebase.firestore.Timestamp.now(),
                paymentHistory: [],

                // 🧩 New fields for Referrals & Stripe integration
                founderPhase: true,
                referralsCompleted: 0,
                plusReferralsCompleted: 0,
                referralBonusAvailable: false,
                nextCyclePrice: 0,
                stripeCustomerId: "",
                referredBy: referredBy
            };

            return db.collection("users").doc(userId).set(userData);
        })
        .then(() => {
            return fetch("https://formsubmit.co/ajax/info@autocuidadoclub.com", {
                method: "POST",
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    name: name,
                    email: email,
                    phone: phone,
                    subject: "new register in the platafform",
                    message: `Nuevo usuario registrado:\nNombre: ${name}\nEmail: ${email}\nTeléfono: ${phone}`
                })
            });
        })
        .then(() => {
            loader.style.display = "none";

            const successOverlay = document.getElementById("successOverlay");
            if (successOverlay) {
                successOverlay.style.display = "flex";
            }

            setTimeout(() => {
                window.location.href = "login.html";
            }, 2500);
        })
        .catch((error) => {
            console.error("❌ Error en el registro:", error.message);
            alert("❌ Error en el registro: " + error.message);
            loader.style.display = "none";
        });
}


            
           window.selectScheduleBox = function (cell) {
    const cells = document.querySelectorAll(".schedule-table tbody td");
    const timeBlock = cell.innerText.trim();

    if (timeBlock === "-" || timeBlock === "") {
        alert("Por favor, seleccione un horario válido.");
        return;
    }

    cells.forEach((c) => c.classList.remove("selected-box"));
    cell.classList.add("selected-box");

    const dayIndex = cell.cellIndex;
    const dayHeader = document.querySelector(`.schedule-table thead th:nth-child(${dayIndex + 1})`);
    const day = dayHeader ? dayHeader.innerText.trim() : "Día desconocido";

    document.getElementById("selectedDay").value = day;
    document.getElementById("selectedTime").value = timeBlock;

    // Update the confirmation message below the table
    const confirmationMessage = document.getElementById("confirmation-message");
    confirmationMessage.innerText = `${day} - ${timeBlock}`;

    const registerButton = document.getElementById("register-button");
if (registerButton) {
    registerButton.disabled = true;
    registerButton.innerText = "Registrando...";
}


    console.log(`📅 Horario seleccionado: ${day} - ${timeBlock}`);

                        if (typeof _pe !== "undefined") {
    _pe.tagPushSubscriber('not_paid_yet');
    console.log("📬 PushEngage tag applied: not_paid_yet");
}


};

function isMobileDevice() {
  return /android|iphone|ipad|ipod/i.test(navigator.userAgent);
}

planButtons.forEach(button => {
    button.addEventListener("click", function () {
        selectedPlanType = this.getAttribute("data-plan");
        updateVehicleFields(selectedPlanType);
        registrationContainer.style.display = "block";

        // Delay inteligente para asegurar render correcto
        setTimeout(() => {
            registrationContainer.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }, isMobileDevice() ? 400 : 100);

        console.log(`✅ Plan seleccionado: ${selectedPlanType}`);
    });
});

           function updateVehicleFields(planType) {
    const vehicleContainer = document.getElementById("vehicle-container");
    vehicleContainer.innerHTML = "";

    const maxVehicles = planType.includes("plus") ? 3 : 1;
    for (let i = 0; i < maxVehicles; i++) {
        const vehicleEntry = document.createElement("div");
        vehicleEntry.classList.add("vehicle-entry");
        vehicleEntry.innerHTML = `
            <h4>Vehículo ${i + 1}</h4>
            <label>Placa:</label>
            <input type="text" class="plate" placeholder="Ej: P123-456" title="Ej: P123456" autocomplete="off" required>

            <label>Modelo:</label>
            <input type="text" class="model" placeholder="Ej: Corolla" title="Ej: Corolla" autocomplete="off" required>

            <label>Marca:</label>
            <input type="text" class="brand" placeholder="Ej: Toyota" title="Ej: Toyota" autocomplete="off" required>

            <label>Año:</label>
            <input type="number" class="year" placeholder="Ej: 2020" title="Ej: 2020" autocomplete="off" required>
        `;
        vehicleContainer.appendChild(vehicleEntry);
    }

    console.log(`✅ Vehículos preparados: Plan ${planType.includes("plus") ? "Plus (3)" : "Basic (1)"}`);
}
        });
    </script>

    <style>
      .disclaimer-box {
  font-size: 4rem; /* puedes subir a 1.3rem o 1.4rem si quieres aún más grande */
  line-height: 1.6;
  padding: 16px;
  background-color: #f9f9f9;
  border-left: 4px solid #ff9800;
  margin-top: 20px;
  border-radius: 6px;
}

        body, html {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}
        /* Ensures full screen width usage */
body, html {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}

/* Ensure all main containers use full width */
.main-container, .content-container {
    width: 100%;
    max-width: 100%;
    padding: 0 10px;
}

/* Flexbox layout for better responsiveness */
.subscription-row {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;
    gap: 20px; /* Space between each plan */
}

/* Make sure each plan item uses full width on smaller screens */
.plan-item {
    width: 100%; /* Full width on mobile */
    max-width: 300px; /* Limit to a max width for larger screens */
    box-sizing: border-box;
}

/* Adjust plan item images to be responsive */
.plan-image {
    max-width: 100%;
    height: auto;
}

/* Styling for the disclaimer box */
.disclaimer-box {
    background-color: #f8f8f8;
    border: 1px solid #ddd;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
    font-size: 14px;
    margin-top: 20px;
}

/* Adjustments for smaller screens */
@media (max-width: 768px) {
    /* Ensure the navbar and logo scale appropriately on mobile */
    .navbar {
        padding: 10px;
    }

    .plan-item {
        width: 100%;  /* Full width for each plan on mobile */
        margin-bottom: 20px;
    }

    .plan-image {
        max-width: 100%; /* Ensures images scale properly */
    }

    .subscription-row {
        display: block; /* Stack plans vertically on mobile */
    }

    /* Adjust the disclaimer text for smaller devices */
    .disclaimer-box p {
        font-size: 13px;
    }
}

        .card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
        }
        label {
            font-weight: bold;
        }
        select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
      
        .graphic-container {
  text-align: center;
  margin: 20px 0;
}

.plan-graphic {
  max-width: 100%;
  height: auto;
  border: 1px solid #ccc;
  border-radius: 8px;
}

        
    .container {
      max-width: 700px;
      margin: auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      margin-top: 20px;
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    button {
      margin-top: 20px;
      background: #003366;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background: #ff6600;
    }

    .success-overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,51,102,0.9);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      text-align: center;
    }

    .loader {
      border: 8px solid #f3f3f3;
      border-top: 8px solid #ff6600;
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin-top: 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

.schedule-section {
  overflow-x: auto;
}

.schedule-table {
  min-width: 90px; /* Adjust if needed */
  width: 100%;
  border-collapse: collapse;
}
        .faq {
  margin-bottom: 24px;
  padding: 16px;
  background-color: #fdfdfd;
  border: 1px solid #e0e0e0;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
  transition: background-color 0.3s ease;
}

.faq:hover {
  background-color: #fafafa;
}

.faq h3 {
  font-size: 1.2rem;
  margin-bottom: 10px;
  color: #ff6600;
  cursor: pointer;
}

.faq p {
  font-size: 1rem;
  line-height: 1.6;
  color: #333;
  padding-left: 8px;
  padding-right: 8px;
}

        </style>
</head>

<body>
     <div id="fb-root"></div>
<script async defer crossorigin="anonymous" 
src="https://connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v22.0"></script>
    
    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="nosotros.html">¿Quiénes Somos?</a></li>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="servicios.html">Servicios</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            <li><a href="login.html">Ingresa a tu cuenta</a></li>
            <li><a href="centro-ayuda.html">Centro de Ayuda</a></li>

        </ul>
        <div class="logo-container">
            <img src="logo.jpg" alt="AutoCuidado Club Logo" class="logo">
        </div>
    </nav>

   
   <header style="background: linear-gradient(to bottom, #002F6C, #003366); padding: 60px 20px; text-align: center;">
    <div class="header-text">
        <h1 style="color: white; font-size: 2.5em; margin-bottom: 15px;">Bienvenido a AutoCuidado Club</h1>
        <p style="color: white; font-size: 1.2em;">Tu tiempo vale oro. Nosotros lo cuidamos por ti, mientras cuidamos tu vehículo.</p>
    </div>
</header>


<!-- Disclaimer Box -->
<style>
    /* Style the disclaimer box */
.disclaimer-box {
    background-color: #f8f8f8; /* Light gray background */
    border: 1px solid #ddd;   /* Gray border */
    padding: 20px;             /* Add padding around the text */
    border-radius: 8px;       /* Rounded corners */
    box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1); /* Soft shadow */
    font-size: 14px;           /* Set a smaller font size */
    margin-top: 20px;          /* Add some space from the top */
}

/* Style the "Nota" text to make it stand out */
.disclaimer-box strong {
    color: #003366; /* Dark blue color for emphasis */
}
</style>
    
    <div class="disclaimer-box">
  <p>
    <strong>Nota:</strong> Los servicios de AutoCuidado Club están diseñados exclusivamente para motores de gasolina. Esto está alineado con nuestro compromiso de ofrecer movilidad con una huella de carbono más baja. Según la Agencia Europea de Medio Ambiente (EEA), los motores diésel son responsables de hasta 20 veces más contaminación que los de gasolina.
  </p>
</div>


<style>
   /* Flexbox layout for the image container */
.image-container {
  display: flex;
  justify-content: space-between; /* Space between the images */
  gap: 20px; /* Add space between the images */
  margin-top: 20px;
}

/* Align images in the center vertically */
.graphic-container {
  display: flex;
  flex-direction: column;
  justify-content: center; /* Vertically centers the content */
  width: 48%; /* Ensures the images are placed side by side */
  text-align: center;
}

.plan-graphic {
  max-width: 100%;
  height: auto;
  border: 1px solid #ccc;
  border-radius: 8px;
}

</style>
        
    <!-- Subscription Plans -->
    <section>

<h2 style="margin-top: 30px; margin-bottom: 30px;">Planes de Suscripciones Básicas (cobertura: 1 vehículo)</h2>
<div class="subscription-row">

    <!-- 3-Month Plan -->
    <div class="plan-item highlight">
        <div class="plan-option">
            <img src="3mb.jpg" alt="Plan Básico 3 meses" class="plan-image">
            <p><strong>3 meses:</strong> <del>$36.99</del> <strong style="color: #ff6600;">$34.99/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>3 inspecciones preventivas (una cada mes).</li>
                <li>💸 Ahorro vs precio regular.</li>
                <li>💸 Precio regular: $36.99</li>
                <li>💰 Precio fundador anual: $419.88</li>
                <li>3 inspecciones preventivas (una cada mes).</li>
                <li><strong>Beneficio:</strong> Ideal para probar el servicio sin compromiso a largo plazo.</li>
            </ul>
            <button class="plan-button" data-plan="basic3m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

    <!-- 6-Month Plan -->
    <div class="plan-item highlight">
        <div class="plan-option">
            <img src="6mb.jpg" alt="Plan Básico 6 meses" class="plan-image">
            <p><strong>6 meses:</strong> <del>$34.50</del> <strong style="color: #ff6600;">$32.50/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>6 inspecciones preventivas (una cada mes).</li>
                <li>💸 Ahorro vs precio regular.</li>
                 <li>💸 Precio regular Mensual: $34.50</li>
                <li>💰 Precio fundador anual: $390.00</li>
                <li>🎉 Ahorro anual: $29.88 comparado con plan 3 meses.</li>
                <li>6 inspecciones preventivas (una cada mes).</li>
                <li><strong>Beneficio:</strong> Ahorro mensual y servicio confiable a mediano plazo.</li>
            </ul>
            <button class="plan-button" data-plan="basic6m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

    <!-- 12-Month Plan -->
    <div class="plan-item highlight">
        <div class="discount-badge">🎖️ Mejor Opción Anual</div>
        <div class="plan-option">
            <img src="12mb.jpg" alt="Plan Básico 12 meses" class="plan-image">
            <p><strong>12 meses:</strong> <del>$31.99</del> <strong style="color: #ff6600;">$29.99/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>12 inspecciones preventivas (una cada mes).</li>
                <li>🎯 Incluye Programa de Lealtad.</li>
                <li>💸 Precio regular Mensual: $31.99</li>
                <li>💰 Precio fundador anual: $359.88</li>
                <li>🎉 Ahorro: $59.97 anual frente a plan 3 meses, el equivalente a 2 meses gratis con esta suscripción.</li>
                <li>12 inspecciones preventivas (una cada mes).</li>
                <li><strong>⭐Beneficio:</strong> Ahorro anual y mantenimiento sin sorpresas durante el año.</li>
                <li>🏆 **Premio de Fidelidad:** Si completas 8 meses consecutivos de pago, desbloqueas automáticamente tus recompensas en el mes 9.</li>
            </ul>
            <button class="plan-button" data-plan="basic12m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

</div>

<h2 style="margin-top: 30px; margin-bottom: 30px;">Planes de Suscripciones Plus (cobertura: 3 vehículos)</h2>
<div class="subscription-row">

    <!-- 3-Month Plus Plan -->
    <div class="plan-item">
        <div class="plan-option">
            <img src="3mp.jpg" alt="Plan Plus 3 meses" class="plan-image">
            <p><strong>3 meses:</strong> <del>$73.99</del> <strong style="color: #ff6600;">$68.99/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>3 inspecciones preventivas por vehículo (3 vehículos).</li>
                <li>✅ Prioridad de programación.</li>
                <li>💸 Precio regular Mensual: $73.99</li>
                <li>💰 Precio funador anual: $846.00</li>
                <li>3 inspecciones preventivas (una cada mes).</li>
                <li><strong>Beneficio:</strong> Ideal para probar el servicio sin compromiso a largo plazo.</li>
            </ul>
            <button class="plan-button" data-plan="plus3m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

    <!-- 6-Month Plus Plan -->
    <div class="plan-item">
        <div class="plan-option">
            <img src="6mp.jpg" alt="Plan Plus 6 meses" class="plan-image">
            <p><strong>6 meses:</strong> <del>$69.99</del> <strong style="color: #ff6600;">$65.00/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>6 inspecciones preventivas por vehículo (3 vehículos).</li>
                <li>✅ Prioridad de programación.</li>
                <li>💸 Precio regular Mensual: $69.99</li>
                <li>💰 Precio fundador anual: $791.88/li>
                <li>🎉 Ahorro anual: $29.88 comparado con plan 3 meses.</li>
                <li>6 inspecciones preventivas (una cada mes).</li>
                <li><strong>Beneficio:</strong> Ahorro mensual y servicio confiable a mediano plazo.</li>
            </ul>
            <button class="plan-button" data-plan="plus6m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

    <!-- 12-Month Plus Plan -->
    <div class="plan-item highlight">
        <div class="discount-badge">🎖️ Mejor Opción Anual</div>
        <div class="plan-option">
            <img src="12mp.jpg" alt="Plan Plus 12 meses" class="plan-image">
            <p><strong>12 meses:</strong> <del>$64.99</del> <strong style="color: #ff6600;">$59.99/mes</strong> 🚀</p>
            <ul class="plan-benefits">
                <li>12 inspecciones preventivas por vehículo (3 vehículos).</li>
                <li>🎯 Incluye Programa de Lealtad.</li>
                <li>💸 Precio Mensual: $64.99 (19.99 por vehiculo).</li>
                <li>💰 Precio fundador Anual: $719.88</li>
                <li>🎉 Ahorro: $111.12 anual frente a plan 3 meses.</li>
                <li>12 inspecciones preventivas por vehículo (una cada mes).</li>
                <li><strong>Beneficio:</strong> Gran ahorro anual para varios vehículos.</li>
                <li>🏆 **Premio de Fidelidad:** Si completas 8 meses consecutivos de pago, desbloqueas automáticamente tus recompensas en el mes 9.</li>
            </ul>
            </ul>
            <button class="plan-button" data-plan="plus12m">¡Quiero este plan!</button>
            <p style="font-size:14px; margin-top:10px; color:#003366;">🚀 Asegurá tu tarifa especial de fundador para siempre. Solo por tiempo limitado.</p>
             <a href="tac.html" target="_blank">Ver términos y condiciones</a>
                <a href="contacto.html" target="_blank">¿Dudas? Contáctanos</a>
        </div>
    </div>

</div>

</section>


        <!-- Optional styles -->
<section>
  <h2>📊 Comparación de Planes y Descuentos</h2>
  <div class="image-container">
    <!-- Left Graphic: Precio por Vehículo -->
    <div class="graphic-container">
      <h3>Precio por Vehículo</h3>
      <img src="pricepercar.png" alt="Precio por Vehículo" class="plan-graphic">
        <p>Los planes plus son ejecutados para paquetes de 3 vehículos, esta comparación se hace para precios por vehículos</p>
    </div>

    <!-- Right Graphic: Ahorro Anual por Vehículo -->
    <div class="graphic-container">
      <h3>Ahorro Anual por Vehículo</h3>
      <img src="savesgraphics.png" alt="Ahorro Anual por Vehículo" class="plan-graphic">
        <p>La comparación ejecutada se desarrolla contra el precio regular de los planes de suscripción de 12 meses divido por cada vehíulo  y el precio regular del plan básico de 3 meses</p>
    </div>
  </div>
</section>


    <h2>🔥 ¿Por qué elegir los planes de 12 meses?</h2>
    <!-- Loyalty Program & Explanation -->
    <section style="display: flex; flex-wrap: wrap; justify-content: center; gap: 20px; margin-top: 30px;">
       
    <!-- Box Plan PLUS -->
    <div class="comparison-box">
        <h3>💎 Plan 12 Meses PLUS</h3>
        <ul>
            <li>💰 <strong>Ahorra $180/año</strong></li>
            <li>✅ <strong>5.5 meses gratis</strong></li>
            <li>✔ Servicio para <strong>3 vehículos</strong></li>
            <li>🎁 Recompensas al mes 8</li>
        </ul>
    </div>

    <!-- Box Plan BASIC -->
    <div class="comparison-box">
        <h3>💰 Plan 12 Meses BASIC</h3>
        <ul>
            <li>💰 <strong>Ahorra $60/año</strong></li>
            <li>✅ <strong>1.8 meses gratis</strong></li>
            <li>✔ Servicio para <strong>1 vehículo</strong></li>
            <li>🎁 Recompensas al mes 8</li>
        </ul>
    </div>

    <!-- Box Cómo alcanzar recompensas -->
    <div class="comparison-box" style="background-color: #fff3e6;">
        <h3>🎯 ¿Cómo alcanzar tus recompensas?</h3>
        <ul>
            <li>🔁 3 renovaciones de <strong>3 meses</strong></li>
            <li>🔁 2 renovaciones de <strong>6 meses</strong></li>
            <li>🎉 1 contratación de <strong>12 meses</strong></li>
        </ul>
    </div>

</section>

        
    <div id="registration-container" style="display: none;">
    <h2>Registro en AutoCuidado Club</h2>
    <form id="registerForm">
<!-- Nombre -->
<label for="name">Nombre:</label>
<input type="text" id="name" placeholder="Ingrese su nombre completo" title="Ingrese su nombre completo" autocomplete="name" required>

<!-- Email -->
<label for="email">Email:</label>
<input type="email" id="email" placeholder="ejemplo@correo.com" title="Ingrese su correo electrónico" autocomplete="email" required>

<!-- Teléfono -->
<label for="phone">Teléfono:</label>
<input type="text" id="phone" placeholder="Número de teléfono" title="Ingrese su número de teléfono" autocomplete="tel" required>

<!-- Contraseña -->
<label for="password">Contraseña:</label>
<input type="password" id="password" placeholder="Cree una contraseña segura" title="Cree una contraseña segura" autocomplete="new-password" required>


        <div id="vehicle-section">
    <h3>Datos del Vehículo</h3>
    <div id="vehicle-container">
       <div class="vehicle-entry">
    <!-- Contents for vehicle entry -->
   <label for="plate">Placa:</label>
<input type="text" id="plate" class="plate" placeholder="Ej: P123-456" title="Ej: P123456" required>

<label for="model">Modelo:</label>
<input type="text" id="model" class="model" placeholder="Ej: Corolla" title="Ej: Corolla" required>

<label for="brand">Marca:</label>
<input type="text" id="brand" class="brand" placeholder="Ej: Toyota" title="Ej: Toyota" required>

<label for="year">Año:</label>
<input type="number" id="year" class="year" placeholder="Ej: 2020" title="Ej: 2020" required>

    <button type="button" onclick="removeVehicle(this)">Eliminar</button>
</div>

    </div>
   </div>

        <!-- Schedule Section -->
    <section id="schedule-section" class="schedule-section">
        <h2>Selecciona tu Horario</h2>
        <p>Ten en cuenta que puedes cambiar el dia y la hora de tu inspección desde el tablero de usuario ingresando a tu cuenta luego de finalizar este registro</p>
        <table class="schedule-table">
            <thead>
                <tr>
                    <th>Horario</th>
                    <th>Lunes</th>
                    <th>Miércoles</th>
                    <th>Viernes</th>
                    <th>Sábado</th>
                    <th>Domingo</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td></td>
                    <td onclick="selectScheduleBox(this)">9:00 - 11:00</td>
                    <td onclick="selectScheduleBox(this)">10:00 - 12:00</td>
                    <td onclick="selectScheduleBox(this)">13:00 - 15:00</td>
                    <td onclick="selectScheduleBox(this)">8:00 - 10:00</td>
                    <td onclick="selectScheduleBox(this)">9:00 - 11:00</td>
                </tr>
                <tr>
                    <td></td>
                    <td onclick="selectScheduleBox(this)">12:00 - 14:00</td>
                    <td onclick="selectScheduleBox(this)">13:00 - 15:00</td>
                    <td onclick="selectScheduleBox(this)">16:00 - 18:00</td>
                    <td onclick="selectScheduleBox(this)">11:00 - 13:00</td>
                    <td onclick="selectScheduleBox(this)">12:00 - 14:00</td>
                </tr>
                <tr>
                    <td></td>
                    <td onclick="selectScheduleBox(this)">15:00 - 17:00</td>
                    <td onclick="selectScheduleBox(this)">16:00 - 18:00</td>
                    <td onclick="selectScheduleBox(this)">-</td>
                    <td onclick="selectScheduleBox(this)">14:00 - 16:00</td>
                    <td onclick="selectScheduleBox(this)">-</td>
                </tr>
            </tbody>
        </table>


        <input type="hidden" id="selectedDay" required>
        <input type="hidden" id="selectedTime" required>

        <div id="schedule-confirmation" class="schedule-confirmation">
    <p>📅 Horario seleccionado: <span id="confirmation-message">Ningún horario seleccionado</span></p>
</div>

        <div class="card">
    <h3>Seleccione su Ubicación</h3>
    <label for="department">Departamento:</label>
    <select id="department" onchange="updateMunicipalities()" required>
        <option value="">Seleccione un departamento</option>
    </select>
    
    <label for="municipality">Municipio:</label>
    <select id="municipality" required>
        <option value="">Seleccione un municipio</option>
    </select>
    
    
    <script>
    function selectScheduleBox(cell) {
    const cells = document.querySelectorAll(".schedule-table tbody td");

    // Get the clicked cell's text
    const timeBlock = cell.innerText.trim();

    // Validate the clicked cell
    if (timeBlock === "-" || timeBlock === "") {
        alert("Por favor, seleccione un horario válido.");
        return; // Do not allow selection of invalid cells
    }

    // Remove selection from all other cells
    cells.forEach((c) => c.classList.remove("selected-box"));

    // Highlight the selected cell
    cell.classList.add("selected-box");

    // Get the corresponding day from the column header
    const dayIndex = cell.cellIndex; // Get the column index of the clicked cell
    const dayHeader = document.querySelector(`.schedule-table thead th:nth-child(${dayIndex + 1})`);
    const day = dayHeader ? dayHeader.innerText.trim() : "Día desconocido";

    // Update the hidden input field to include both the day and time block
    const scheduleField = document.getElementById("selectedSchedule");
    if (scheduleField) {
        scheduleField.value = `${day} - ${timeBlock}`;
    }

    console.log(`Horario seleccionado: ${day} - ${timeBlock}`);
}

        const locations = {
            "Ahuachapán": ["Ahuachapán", "Apaneca", "Atiquizaya", "Concepción de Ataco", "El Refugio", "Guaymango", "Jujutla", "San Francisco Menéndez", "San Lorenzo", "San Pedro Puxtla", "Tacuba", "Turín"],
            "Santa Ana": ["Candelaria de la Frontera", "Chalchuapa", "Coatepeque", "El Congo", "El Porvenir", "Masahuat", "Metapán", "San Antonio Pajonal", "San Sebastián Salitrillo", "Santa Ana", "Santa Rosa Guachipilín", "Texistepeque"],
            "Sonsonate": ["Acajutla", "Armenia", "Caluco", "Cuisnahuat", "Izalco", "Juayúa", "Nahuizalco", "Nahulingo", "Salcoatitán", "San Antonio del Monte", "San Julián", "Santa Catarina Masahuat", "Santa Isabel Ishuatán", "Santo Domingo de Guzmán", "Sonsonate", "Sonzacate"],
            "Chalatenango": ["Agua Caliente", "Arcatao", "Azacualpa", "Chalatenango", "Citalá", "Comalapa", "Concepción Quezaltepeque", "Dulce Nombre de María", "El Carrizal", "El Paraíso", "La Laguna", "La Palma", "Las Flores", "Las Vueltas", "Nueva Concepción", "Nueva Trinidad", "Ojos de Agua", "Potonico", "San Antonio de la Cruz", "San Antonio Los Ranchos", "San Fernando", "San Francisco Lempa", "San Francisco Morazán", "San Ignacio", "San Isidro Labrador", "San José Cancasque", "San José Las Flores", "San Luis del Carmen", "San Miguel de Mercedes", "San Rafael", "Santa Rita", "Tejutla"],
            "Cuscatlán": ["Candelaria", "Cojutepeque", "El Carmen", "El Rosario", "Monte San Juan", "Oratorio de Concepción", "San Bartolomé Perulapía", "San Cristóbal", "San José Guayabal", "San Pedro Perulapán", "San Rafael Cedros", "San Ramón", "Santa Cruz Analquito", "Santa Cruz Michapa", "Suchitoto", "Tenancingo"],
            "San Salvador": ["Aguilares", "Apopa", "Ayutuxtepeque", "Ciudad Delgado", "Cuscatancingo", "El Paisnal", "Guazapa", "Ilopango", "Mejicanos", "Nejapa", "Panchimalco", "Rosario de Mora", "San Marcos", "San Martín", "San Salvador", "Santiago Texacuangos", "Santo Tomás", "Soyapango", "Tonacatepeque"],
            "La Libertad": ["Antiguo Cuscatlán", "Chiltiupán", "Ciudad Arce", "Colón", "Comasagua", "Huizúcar", "Jayaque", "Jicalapa", "La Libertad", "Nuevo Cuscatlán", "San Juan Opico", "Quezaltepeque", "Sacacoyo", "San José Villanueva", "San Matías", "San Pablo Tacachico", "Talnique", "Tamanique", "Teotepeque", "Tepecoyo", "Zaragoza"],
            "San Vicente": ["Apastepeque", "Guadalupe", "San Cayetano Istepeque", "San Esteban Catarina", "San Ildefonso", "San Lorenzo", "San Sebastián", "San Vicente", "Santa Clara", "Santo Domingo", "Tecoluca", "Tepetitán", "Verapaz"],
            "Cabañas": ["Cinquera", "Dolores", "Guacotecti", "Ilobasco", "Jutiapa", "San Isidro", "Sensuntepeque", "Tejutepeque", "Victoria"],
            "Usulután": ["Alegría", "Berlín", "California", "Concepción Batres", "El Triunfo", "Ereguayquín", "Estanzuelas", "Jiquilisco", "Jucuapa", "Jucuarán", "Mercedes Umaña", "Nueva Granada", "Ozatlán", "Puerto El Triunfo", "San Agustín", "San Buenaventura", "San Dionisio", "San Francisco Javier", "Santa Elena", "Santa María", "Santiago de María", "Tecapán", "Usulután"],
            "San Miguel": ["Carolina", "Chapeltique", "Chinameca", "Chirilagua", "Ciudad Barrios", "Comacarán", "El Tránsito", "Lolotique", "Moncagua", "Nueva Guadalupe", "Nuevo Edén de San Juan", "Quelepa", "San Antonio", "San Gerardo", "San Jorge", "San Luis de la Reina", "San Miguel", "San Rafael Oriente", "Sesori", "Uluazapa"],
            "Morazán": ["Arambala", "Cacaopera", "Chilanga", "Corinto", "Delicias de Concepción", "El Divisadero", "El Rosario", "Gualococti", "Guatajiagua", "Joateca", "Jocoaitique", "Jocoro", "Lolotiquillo", "Meanguera", "Osicala", "Perquín", "San Carlos", "San Fernando", "San Francisco Gotera", "San Isidro", "San Simón", "Sensembra", "Sociedad", "Torola", "Yamabal", "Yoloaiquín"],
            "La Unión": ["Anamorós", "Bolívar", "Concepción de Oriente", "Conchagua", "El Carmen", "El Sauce", "Intipucá", "La Unión", "Lislique", "Meanguera del Golfo", "Nueva Esparta", "Pasaquina", "Polorós", "San Alejo", "San José", "Santa Rosa de Lima", "Yayantique", "Yucuaiquín"]
        };
        const departmentSelect = document.getElementById("department");
        const municipalitySelect = document.getElementById("municipality");

        // Populate the departments dropdown
        function populateDepartments() {
            for (const department in locations) {
                const option = document.createElement("option");
                option.value = department;
                option.textContent = department;
                departmentSelect.appendChild(option);
            }
        }

        // Update municipalities based on selected department
        function updateMunicipalities() {
            const selectedDepartment = departmentSelect.value;
            municipalitySelect.innerHTML = '<option value="">Seleccione un municipio</option>'; // Reset municipalities

            if (locations[selectedDepartment]) {
                locations[selectedDepartment].forEach(municipality => {
                    const option = document.createElement("option");
                    option.value = municipality;
                    option.textContent = municipality;
                    municipalitySelect.appendChild(option);
                });
            }
        }

        // Initialize departments on page load
        document.addEventListener("DOMContentLoaded", populateDepartments);

        function addVehicle() {
        const vehicleContainer = document.getElementById("vehicle-container");
        if (vehicleContainer.children.length >= 3) {
            alert("Solo puedes agregar hasta 3 vehículos.");
            return;
        }

        const newVehicle = document.createElement("div");
        newVehicle.classList.add("vehicle-entry");
        newVehicle.innerHTML = `
            <label for="plate">Placa:</label>
            <input type="text" class="plate" required>

            <label for="model">Modelo:</label>
            <input type="text" class="model" required>

            <label for="brand">Marca:</label>
            <input type="text" class="brand" required>

            <label for="year">Año:</label>
            <input type="number" class="year" required>

            <button type="button" onclick="removeVehicle(this)">Eliminar</button>
        `;
        vehicleContainer.appendChild(newVehicle);
    }

    function removeVehicle(button) {
        button.parentElement.remove();
    }

                
    </script>

<input type="hidden" id="referredBy" name="referredBy">

<!-- Checkbox for Terms and Conditions -->
    <div style="margin-top: 35px;">
        <input type="checkbox" id="terms" name="terms" required>
        <label for="terms">
           He leído y acepto los <button type="button" onclick="window.open('tac.html', '_blank')">Términos y Condiciones</button>.
        </label>
    </div>
            <p></p>
            <p></p>

            
        <button type="submit">Registrarse</button>
    
        </div>
    </section>
    </form>
    </div>

    <div id="successOverlay" class="success-overlay" style="display:none;">
  <h2>✅ Registro exitoso</h2>
  <p>Redirigiendo a tu cuenta...</p>
  <div class="loader"></div>
</div>
    
 
            <script>
document.addEventListener("DOMContentLoaded", function () {
    console.log("✅ DOM fully loaded!");

    const registrationContainer = document.getElementById("registration-container");

    if (!registrationContainer) {
        console.error("❌ Error: No se encontró el contenedor de registro en el DOM.");
        return;
    }

    const planButtons = document.querySelectorAll(".plan-button");

    // ✅ Attach event listeners to all plan buttons
    planButtons.forEach(button => {
    button.addEventListener("click", function () {
        selectedPlanType = this.getAttribute("data-plan");
        updateVehicleFields(selectedPlanType);
        registrationContainer.style.display = "block";

        // Delay inteligente para asegurar render correcto
        setTimeout(() => {
            registrationContainer.scrollIntoView({
                behavior: "smooth",
                block: "start"
            });
        }, isMobileDevice() ? 400 : 100);

        console.log(`✅ Plan seleccionado: ${selectedPlanType}`);
    });
});


    // ✅ Modify registerUser function to use selectedPlanType
    window.registerUser = function(event) {
        event.preventDefault();
         const loader = document.getElementById("loader");
    loader.style.display = "flex"; // ⏳ Show loader

        if (!selectedPlanType) {
            alert("❌ Error: Debes seleccionar un plan antes de registrarte.");
          loader.style.display = "none";
            return;
        }

        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const phone = document.getElementById("phone").value.trim();
        const password = document.getElementById("password").value.trim();
        const department = document.getElementById("department").value;
        const municipality = document.getElementById("municipality").value;

        const selectedDay = document.getElementById("selectedDay").value;
        const selectedTime = document.getElementById("selectedTime").value;
         const referralCode = document.getElementById("referralCode").value.trim();

        const vehicles = [];
        document.querySelectorAll(".vehicle-entry").forEach(entry => {
            vehicles.push({
                plate: entry.querySelector(".plate").value || "",
                model: entry.querySelector(".model").value || "",
                brand: entry.querySelector(".brand").value || "",
                year: entry.querySelector(".year").value || "",
                inspectionDates: []  // ✅ Inicializa campo vacío
            });
        });


        if (!name || !email || !phone || !password || !department || !municipality || !selectedDay || !selectedTime) {
            alert("❌ Todos los campos son obligatorios.");
            return;
        }

        auth.createUserWithEmailAndPassword(email, password)
    .then((userCredential) => {
        const userId = userCredential.user.uid;
        const paymentDate = new Date();
        const nextPaymentDate = new Date();
        nextPaymentDate.setMonth(paymentDate.getMonth() + 1);

    const messaging = firebase.messaging();
          return messaging.getToken({ vapidKey: "BL9OlnifN3KktMZjAq933dl5SJqvple35ZmLZ-1vHXrZenzozjhHhVA-IhLoMX2Flh7NiNjPwjHQosSCDnLf5YE" })
  .then((token) => {
    console.log("✅ pushToken obtenido:", token);
   return db.collection("users").doc(userId).set({
  uid: userId,
  name,
  email,
  phone,
  planType: selectedPlanType,
  department,
  municipality,
  registrationDate: firebase.firestore.Timestamp.now(),
  lastUpgradeDate: firebase.firestore.Timestamp.now(),
  schedule: {
    day: selectedDay,
    time: selectedTime
  },
  paymentDate: firebase.firestore.Timestamp.fromDate(paymentDate),
  nextPaymentDate: firebase.firestore.Timestamp.fromDate(nextPaymentDate),
  paymentStatus: "Pending",
  subscriptionStatus: "active",
  monthsPaid: 0,
  vehicles,
  freeRescheduleClaimed: false,
  referredBy: referredByEmail,

  // 🧩 Loyalty Program Fields
  loyaltyCycle: 0,
  lastLoyaltyReset: firebase.firestore.Timestamp.now(),
  paymentHistory: []
});

       if (referralCode && referralCode !== userId) {
        await db.collection("referrals").doc(referralCode).set({
          completed: firebase.firestore.FieldValue.increment(1),
          bonuses: firebase.firestore.FieldValue.increment(1)
        }, { merge: true });
        if (typeof _pe !== "undefined") {
        }
      }

        // 📨 Send email to admin
        await fetch("https://formsubmit.co/ajax/info@autocuidadoclub.com", {
            method: "POST",
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                name: name,
                email: email,
                phone: phone,
                subject: "new register in the platafform",
                message: `Nuevo usuario registrado:\nNombre: ${name}\nEmail: ${email}\nTeléfono: ${phone}`
            })
        });


      if (typeof _pe !== "undefined") {
        _pe.tagPushSubscriber('not_paid_yet');
      }

         loader.style.display = "none"; // ✅ Hide loader after all is done
      document.getElementById("successOverlay").style.display = "flex";
      setTimeout(() => { window.location.href = "login.html"; }, 2500);

    } catch (error) {
      console.error("❌ Error:", error);
      alert("Error: " + error.message);
          loader.style.display = "none"; // ⛔ Hide loader on error
    }
  });


        function getNextMonthDate() {
  const date = new Date();
  date.setMonth(date.getMonth() + 1);
  return date;
}

// Then, inside the PayPal success logic or registration confirmation:
const user = firebase.auth().currentUser;
if (user) {
  const userRef = db.collection("users").doc(user.uid);
  userRef.update({
    paymentStatus: "Completed",
    paymentDate: firebase.firestore.Timestamp.now(),
    nextPaymentDate: firebase.firestore.Timestamp.fromDate(getNextMonthDate()),
    paymentHistory: firebase.firestore.FieldValue.arrayUnion({
      date: firebase.firestore.Timestamp.now(),
      amount: 20,
      method: "PayPal",
      status: "Completed"
    })
  });
}
        
       // Create a full-screen overlay
    const overlay = document.createElement("div");
    overlay.style.position = "fixed";
    overlay.style.top = "0";
    overlay.style.left = "0";
    overlay.style.width = "100%";
    overlay.style.height = "100%";
    overlay.style.backgroundColor = "rgba(0, 51, 102, 0.9)";
    overlay.style.display = "flex";
    overlay.style.flexDirection = "column";
    overlay.style.justifyContent = "center";
    overlay.style.alignItems = "center";
    overlay.style.zIndex = "9999";
    overlay.innerHTML = `
        <h2 style="color: white; font-size: 2em; margin-bottom: 20px;">✅ Registro Exitoso</h2>
        <p style="color: white; font-size: 1.2em; margin-bottom: 20px;">Redirigiendo a tu cuenta...</p>
        <div class="loader" style="border: 8px solid #f3f3f3; border-top: 8px solid #ff6600; border-radius: 50%; width: 60px; height: 60px; animation: spin 1s linear infinite;"></div>
    `;

    document.body.appendChild(overlay);

    // CSS Spinner Animation
    const style = document.createElement("style");
    style.innerHTML = `
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    `;
    document.head.appendChild(style);

   // Redirect after 2.5s
setTimeout(() => {
    window.location.href = "login.html";
}, 2500);
})
          .catch((error) => {
    console.error("❌ Error en el registro:", error.message);
    alert("❌ Error en el registro: " + error.message);
});

                function sendEmail(destinationEmail, subject, acmessage) {
    const styledMessage = `
        ${acmessage}
        <br><br>
        Síguenos en nuestras redes sociales:<br>
        📷 Instagram: https://www.instagram.com/autocuidadoclub<br>
        📘 Facebook: https://www.facebook.com/profile.php?id=61566547237325<br>
        💬 WhatsApp: https://wa.me/50376064756
    `;

    return fetch("https://formsubmit.co/ajax/" + destinationEmail, {
        method: 'POST',
        body: new URLSearchParams({
            email: destinationEmail,
            subject,
            message: styledMessage
        })
    });
}


// ✅ Function to Update Vehicle Fields Based on Plan Type
// ✅ Updated Function to Always Create 3 Vehicle Fields & Hide Extra for Basic
function updateVehicleFields(planType) {
    const vehicleContainer = document.getElementById("vehicle-container");
    vehicleContainer.innerHTML = ""; // Clear previous entries

    for (let i = 0; i < 3; i++) {
        const vehicleEntry = document.createElement("div");
        vehicleEntry.classList.add("vehicle-entry");

        // ✅ Hide extra vehicles if Basic plan
        if (!planType.includes("plus") && i > 0) {
            vehicleEntry.style.display = "none"; // Hidden by default
        }

        vehicleEntry.innerHTML = `
            <h4>Vehículo ${i + 1}</h4>
            <label>Placa:</label>
            <input type="text" class="plate">

            <label>Modelo:</label>
            <input type="text" class="model">

            <label>Marca:</label>
            <input type="text" class="brand">

            <label>Año:</label>
            <input type="number" class="year">
        `;
        vehicleContainer.appendChild(vehicleEntry);
    }

    console.log(`✅ Vehículos preparados: Plan ${planType.includes("plus") ? "Plus (3)" : "Basic (1 visible, 3 saved)"}`);
}
        console.log("Before the error point");

                
const termsCheckbox = document.getElementById("terms");

termsCheckbox.addEventListener("invalid", function(event) {
  event.target.setCustomValidity("Por favor, acepta los Términos y Condiciones para continuar.");
});

termsCheckbox.addEventListener("change", function(event) {
  event.target.setCustomValidity("");
});

                
window.addEventListener('load', function() {
  var fbScript = document.createElement('script');
  fbScript.async = true;
  fbScript.defer = true;
  fbScript.crossOrigin = 'anonymous';
  fbScript.src = "https://connect.facebook.net/es_LA/sdk.js#xfbml=1&version=v22.0";
  document.body.appendChild(fbScript);
});

                window.addEventListener('load', function() {
  const ctaBar = document.getElementById('cta-install-bar');
  if (ctaBar) {
    ctaBar.style.display = 'block';
    ctaBar.style.opacity = '1';
    ctaBar.style.transform = 'translateY(0)';
  }
});


            </script>

    

    <div style="display: flex; justify-content: center; margin: 30px 0;">
  <div class="fb-page"
       data-href="https://www.facebook.com/profile.php?id=61575027617474"
       data-tabs="timeline"
       data-width="1000"
       data-height=""
       data-small-header="true"
       data-adapt-container-width="false"
       data-hide-cover="false"
       data-show-facepile="true"
       style="max-width: 1000px; width: 100%;">
    <blockquote cite="https://www.facebook.com/profile.php?id=61575027617474" class="fb-xfbml-parse-ignore">
      <a href="https://www.facebook.com/profile.php?id=61575027617474">Autocuidado Club</a>
    </blockquote>
  </div>
</div>

    
    <div style="background-color: #003893; color: white; padding: 20px; border-radius: 12px 12px 0 0;">
  <div style="display: flex; align-items: center; justify-content: center; flex-wrap: wrap;">
    <img src="/flag-sv.png" alt="Bandera El Salvador" style="height: 60px; margin-right: 20px; border-radius: 6px; box-shadow: 0 0 6px rgba(0,0,0,0.3);">
    <div style="text-align: left; max-width: 300px;">
      <p style="margin: 0; font-size: 18px; font-weight: bold;">
        Esta app es más que tecnología.
      </p>
      <p style="margin: 5px 0 0; font-size: 16px;">
        Es una forma distinta de cuidar lo que importa.
      </p>
    </div>
  </div>
  <p style="text-align: center; margin-top: 20px; font-size: 16px;">
    <span style="color: #FFA500; font-weight: bold;">AutoCuidado Club</span> — Hecha con visión. Hecha con orgullo en <strong>El Salvador.</strong>
  </p>
</div>

        <!-- Footer -->
    <footer>
        <p>&copy; 2025 AutoCuidado Club - Todos los derechos reservados.</p>
        <ul>
            <li><a href="nosotros.html">Quiénes Somos</a></li>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="suscripciones.html">Suscripciones</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            <li><a href="login.html">Ingresa a tu cuenta</a></li>
             <li><a href="tac.html">Términos y Condiciones</a></li>
        </ul>
    </footer>
         
<!-- Fullscreen Loader -->
<div id="loader" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; justify-content: center; align-items: center;">
    <img src="loading.gif" alt="Cargando..." style="width: 80px; border-radius: 8px;">
</div>

   <!-- CTA Footer -->
  <div id="cta-install-bar">
    <div class="cta-message">
  ¿Querés contactarnos, dejarnos tu opinión o instalar la app? <strong>Todo lo tenés aquí.</strong>
</div>

      <!-- CTA Footer -->
<div id="cta-install-bar" style="display:none;">

      <button onclick="openFeedbackModal()">📝 Déjanos tu opinión</button>
      <a href="contacto.html">💬 Contácta con nuestro staff</a>
      <button id="how-to-install-btn">📲 Instalá nuestra APP</button>
    <button onclick="closeCtaInstallBar()" class="close-btn">❌ Cerrar</button>

    </div>
  </div>

  <!-- Feedback Modal -->
<!-- Feedback Modal -->
<div id="feedbackModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:white; padding:20px; border-radius:10px; width:90%; max-width:400px; position:relative;">
  
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
    <h3 style="margin: 0;">Tu opinión sobre AutoCuidado Club</h3>
    <button onclick="closeFeedbackModal()" style="
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #ff0000;
      font-weight: bold;
    ">❌</button>
  </div>

  <form id="voiceFeedbackForm">
    <input type="hidden" name="_subject" value="Feedback (Fase Family & Friends) - AutoCuidado Club">
    <input type="hidden" name="_cc" value="info@autocuidadoclub.com">
    <textarea id="feedbackText" name="message" rows="5" placeholder="Habla o escribe tu mensaje..." style="width:100%; margin-bottom:10px; resize:vertical;" required></textarea>
    <input type="email" name="email" placeholder="Tu correo (opcional)" style="width:100%; margin-bottom:10px;">
    <div style="display:flex; justify-content:space-between;">
      <button type="button" onclick="startVoiceInput()" style="background-color: #ff6600; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold;">🎤 Hablar</button>
      <button type="submit" style="background-color: #003893; color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: bold;">Enviar</button>
    </div>
  </form>

  <div id="feedbackLoader" style="display:none; margin-top:10px; text-align:center;">
    <img src="loading.gif" alt="Cargando..." style="width:80px;">
  </div>

  </div>
</div>


<!-- Botón para volver a mostrar el menú -->
<button id="reopen-cta-btn" style="
  display: none;
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: #ff9800;
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 12px;
  font-weight: bold;
  font-size: 13px;
  cursor: pointer;
  z-index: 9999;
  opacity: 0;
  max-width: 180px;
  width: auto;
  white-space: nowrap;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  transition: opacity 0.3s ease, transform 0.3s ease;
">
📲 Abrir menú
</button>




  <script>
    const installBtn = document.getElementById('how-to-install-btn');
    installBtn.addEventListener('click', () => {
      const isIos = /iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());
      const isAndroid = /android/.test(navigator.userAgent.toLowerCase());
      if (isIos) {
        alert("En iPhone, toca el botón de compartir en Safari y selecciona 'Agregar a pantalla de inicio'.");
      } else if (isAndroid) {
        alert("En Android, abre el menú de Chrome (⋮) y selecciona 'Agregar a pantalla de inicio'.");
      } else {
        alert("Instalación no disponible en este dispositivo.");
      }
    });

    function openFeedbackModal() {
      document.getElementById('feedbackModal').style.display = 'flex';
      document.getElementById('feedbackText').focus();
    }

    function closeFeedbackModal() {
      document.getElementById('feedbackModal').style.display = 'none';
      document.getElementById('voiceFeedbackForm').reset();
      document.getElementById('feedbackLoader').style.display = 'none';
    }

    function startVoiceInput() {
      if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
        alert("Tu navegador no soporta reconocimiento de voz.");
        return;
      }

      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'es-ES';

      const feedbackText = document.getElementById('feedbackText');
      feedbackText.placeholder = "🎙️ Escuchando...";
      feedbackText.style.border = "2px solid orange";

      recognition.onresult = (event) => {
        const result = event.results[0][0].transcript;
        feedbackText.value += (feedbackText.value ? ' ' : '') + result;
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
      };

      recognition.onerror = (event) => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
        alert("Error de voz: " + event.error);
      };

      recognition.onend = () => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
      };

      recognition.start();
    }

   document.getElementById('reopen-cta-btn').addEventListener('click', () => {
  const ctaBar = document.getElementById('cta-install-bar');
  const reopenBtn = document.getElementById('reopen-cta-btn');

  ctaBar.style.display = 'block';
  ctaBar.style.opacity = '1';
  ctaBar.style.transform = 'translateY(0)';
  reopenBtn.style.display = 'none';
});

      document.getElementById('voiceFeedbackForm').onsubmit = function (e) {
      e.preventDefault();
      document.getElementById('feedbackLoader').style.display = 'block';

      fetch("https://formsubmit.co/ajax/info@autocuidadoclub.com", {
        method: "POST",
        body: new FormData(this)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('feedbackLoader').style.display = 'none';
        if (data.success) {
          alert("¡Gracias por tu opinión!");
          closeFeedbackModal();
        } else {
          alert("Error al enviar. Intenta de nuevo.");
        }
      })
      .catch(() => {
        document.getElementById('feedbackLoader').style.display = 'none';
        alert("Hubo un problema al enviar el mensaje.");
      });
    };

      function closeCtaInstallBar() {
    const ctaBar = document.getElementById('cta-install-bar');
    const reopenBtn = document.getElementById('reopen-cta-btn');

    // Animación suave antes de ocultarlo
    ctaBar.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
    ctaBar.style.opacity = '0';
    ctaBar.style.transform = 'translateY(20px)';

    setTimeout(() => {
      ctaBar.style.display = 'none';

      // Mostrar botón flotante después de 5 segundos
      setTimeout(() => {
        reopenBtn.style.display = 'block';
        setTimeout(() => {
          reopenBtn.style.opacity = '1';
        }, 10);
      }, 5000);
    }, 300); // esperar a que termine la transición
  }

      document.getElementById('reopen-cta-btn').addEventListener('click', () => {
  const ctaBar = document.getElementById('cta-install-bar');
  const reopenBtn = document.getElementById('reopen-cta-btn');

  ctaBar.style.display = 'block';
  ctaBar.style.opacity = '1';
  ctaBar.style.transform = 'translateY(0)';
  reopenBtn.style.display = 'none';
});

  </script>


    
</body>
</html>
