<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conoce Nuestras Suscripciones - AutoCuidado Club</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <!-- Firebase Compatibility SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>

    <script>
                const firebaseConfig = {
          apiKey: "AIzaSyBsYS6pHWaTgXzdml-H_y3lQewWgOUezPM",
          authDomain: "auto-cuidadoclub.firebaseapp.com",
          databaseURL: "https://auto-cuidadoclub-default-rtdb.firebaseio.com",
          projectId: "auto-cuidadoclub",
          storageBucket: "auto-cuidadoclub.appspot.com",
          messagingSenderId: "986704701191",
          appId: "1:986704701191:web:fc96ef678d64c1cdcf47a2",
          measurementId: "G-LBBGXV2YX5"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        function loginUser() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    alert("Login exitoso");
                    window.location.href = 'dashboard.html';
                })
                .catch((error) => {
                    console.error("Error en el login:", error.message);
                    alert("Error en el login: " + error.message);
                });
        }

        function showRegistrationForm(planType) {
            document.getElementById('register-section').style.display = 'block';
            document.getElementById('planType').value = planType;
            const vehicleSections = document.getElementById('vehicle-sections');
            vehicleSections.innerHTML = '';
            const vehicleCount = planType.startsWith("plus") ? 3 : 1;
            for (let i = 1; i <= vehicleCount; i++) {
                vehicleSections.insertAdjacentHTML('beforeend', `
                    <div class="vehicle-info">
                        <h4>Información del Vehículo ${i}</h4>
                        <label>Marca:</label>
                        <input type="text" class="vehicleBrand" required>
                        <label>Modelo:</label>
                        <input type="text" class="vehicleModel" required>
                        <label>Año:</label>
                        <input type="text" class="vehicleYear" required pattern="\\d{4}" title="Cuatro dígitos">
                        <label>Placa:</label>
                        <input type="text" class="vehiclePlate" required>
                    </div>
                `);
            }
        }

        function registerAndPay() {
            const name = document.getElementById("name").value;
            const email = document.getElementById("email").value;
            const phone = document.getElementById("phone").value;
            const planType = document.getElementById("planType").value;
            const password = document.getElementById("password").value;

            const vehicles = Array.from(document.querySelectorAll('.vehicle-info')).map(section => ({
                brand: section.querySelector('.vehicleBrand').value,
                model: section.querySelector('.vehicleModel').value,
                year: section.querySelector('.vehicleYear').value,
                plate: section.querySelector('.vehiclePlate').value,
            }));

            const userData = { name, email, phone, planType, vehicles, subscriptionStatus: "active" };
            const usersRef = db.collection("users");

            usersRef.doc(email).get()
                .then(doc => {
                    if (doc.exists && doc.data().subscriptionStatus === "active") {
                        throw new Error("Ya tienes una suscripción activa.");
                    }
                    return auth.createUserWithEmailAndPassword(email, password);
                })
                .then(userCredential => {
                    userData.uid = userCredential.user.uid;
                    return usersRef.doc(email).set(userData);
                })
                .then(() => {
                    alert("Registro exitoso. Presiona OK para proceder al pago.");
                    window.open(getPaypalLink(planType), '_blank');
                })
                .catch(error => {
                    console.error("Error:", error.message);
                    alert(error.message);
                });
        }

        function getPaypalLink(planType) {
            const links = {
                "basic3m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_BASIC_3M",
                "basic6m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_BASIC_6M",
                "basic12m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_BASIC_12M",
                "plus3m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_PLUS_3M",
                "plus6m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_PLUS_6M",
                "plus12m": "https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=ID_PLUS_12M"
            };
            return links[planType] || alert("Plan inválido.");
        }
    </script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="nosotros.html">Nosotros</a></li>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="servicios.html">Servicios</a></li>
            <li><a href="suscripciones.html">Conoce Nuestras Suscripciones</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            </ul>
    <div class="logo-container">
        <img src="logo.jpg" alt="AutoCuidado Club Logo" class="logo">
    </div>
</nav>



<!-- Header with Logo -->
<header>
    <div class="header-container">
            <div class="header-text">
            <h1>Bienvenido a AutoCuidado Club</h1>
            <p>Tu tiempo es oro, nuestro cuidado es total.</p>
        </div>
    </div>
</header>

    
    <!-- Login Section -->
    <section>
        <h2>Iniciar Sesión</h2>
        <form onsubmit="loginUser(); return false;">
            <label>Email: <input type="email" id="email" required></label>
            <label>Contraseña: <input type="password" id="password" required></label>
            <button type="submit">Iniciar Sesión</button>
        </form>
    </section>

    <!-- Registration Section -->
    <section id="register-section" style="display: none;">
        <h2>Registro</h2>
        <form onsubmit="registerAndPay(); return false;">
            <label>Nombre: <input id="name" type="text" required></label>
            <label>Email: <input id="email" type="email" required></label>
            <label>Teléfono: <input id="phone" type="text" required></label>
            <label>Contraseña: <input id="password" type="password" required></label>
            <input id="planType" type="hidden">
            <div id="vehicle-sections"></div>
            <button type="submit">Registrarse y Pagar</button>
        </form>
    </section>

   <!-- Footer -->
    <footer>
        <p>&copy; 2024 AutoCuidado Club - Todos los derechos reservados.</p>
        <ul>
            <li><a href="nosotros.html">Nosotros</a></li>
            <li><a href="index.html">Inicio</a></li>
            <li><a href="servicios.html">Servicios</a></li>
            <li><a href="suscripciones.html">Suscripciones</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            </ul>
       

    <div class="social-container">
        <p>Síguenos en nuestras redes sociales</p>
        <div class="social-buttons">
            <a href="https://www.instagram.com/autocuidadoclub" target="_blank" class="social-button instagram">
                <i class="fab fa-instagram"></i>
            </a>
            <a href="https://www.facebook.com/profile.php?id=61566547237325" target="_blank" class="social-button facebook">
                <i class="fab fa-facebook-f"></i>
            </a>
            <a href="https://x.com/AutoCuidadoClub" target="_blank" class="social-button twitter">
                <!-- Alternative icon for X (Twitter) if not available in Font Awesome -->
                <i class="fab fa-twitter"></i> <!-- Replace with fa-x-twitter if supported -->
            </a>
        </div>
    </div>
    
       
        
       </footer>

</body>
</html>
