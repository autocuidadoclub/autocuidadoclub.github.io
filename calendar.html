<!DOCTYPE html>
<html lang="es">
<head>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database.js"></script>

    <script>
      // Your web app's Firebase configuration
     const firebaseConfig = {
  apiKey: "AIzaSyBsYS6pHWaTgXzdml-H_y3lQewWgOUezPM",
  authDomain: "auto-cuidadoclub.firebaseapp.com",
  projectId: "auto-cuidadoclub",
  storageBucket: "auto-cuidadoclub.appspot.com",
  messagingSenderId: "986704701191",
  appId: "1:986704701191:web:fc96ef678d64c1cdcf47a2",
  measurementId: "G-LBBGXV2YX5"
};
      };

      // Initialize Firebase
      const app = firebase.initializeApp(firebaseConfig);
      const db = firebase.database();
    </script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoCuidado Club - Calendario de Reservas</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<section id="calendar">
    <h2>Calendario de Reservas</h2>
    <p>Consulta la disponibilidad de bloques de tiempo y selecciona el que más te convenga.</p>

    <!-- Calendar HTML -->
    <table id="booking-calendar">
        <tr>
            <th>Lunes</th>
            <th>Miércoles</th>
            <th>Viernes</th>
            <th>Sábado</th>
            <th>Domingo</th>
        </tr>
        <tr>
            <td><button class="available" onclick="bookSlot('Lunes 9:00 - 11:00')">9:00 - 11:00</button></td>
            <td><button class="booked">10:00 - 12:00</button></td>
            <td><button class="available" onclick="bookSlot('Viernes 13:00 - 15:00')">13:00 - 15:00</button></td>
            <td><button class="booked">8:00 - 10:00</button></td>
            <td><button class="available" onclick="bookSlot('Domingo 9:00 - 11:00')">9:00 - 11:00</button></td>
        </tr>
        <tr>
            <td><button class="available" onclick="bookSlot('Lunes 12:00 - 14:00')">12:00 - 14:00</button></td>
            <td><button class="available" onclick="bookSlot('Miércoles 13:00 - 15:00')">13:00 - 15:00</button></td>
            <td><button class="booked">16:00 - 18:00</button></td>
            <td><button class="available" onclick="bookSlot('Sábado 11:00 - 13:00')">11:00 - 13:00</button></td>
            <td><button class="booked">12:00 - 14:00</button></td>
        </tr>
    </table>
</section>

    
<script>
firebase.auth().onAuthStateChanged((user) => {
  if (user) {
    // User is authenticated, allow booking
    console.log("User is logged in: ", user.email);
  } else {
    // Redirect to login page
    alert("Por favor inicia sesión para hacer una reserva.");
    window.location.href = "login.html";  // Assuming you have a login page
  }
});
</script>

<script>
function bookSlot(time) {
    alert("Has reservado: " + time);
    
    // Save to Firebase
    db.ref('bookings/' + time).set({
        booked: true
    });
}

function updateCalendar() {
    db.ref('bookings').on('value', function(snapshot) {
        snapshot.forEach(function(childSnapshot) {
            var timeSlot = childSnapshot.key;
            if (childSnapshot.val().booked) {
                var button = document.querySelector(`button[onclick="bookSlot('${timeSlot}')"]`);
                if (button) {
                    button.classList.add('booked');
                    button.disabled = true;
                }
            }
        });
    });
}

// Call the function to update the calendar on page load
window.onload = function() {
    updateCalendar();
};
</script>

</body>
</html>
