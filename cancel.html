<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Pago cancelado</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
      margin: 0;
      padding-bottom: 120px; /* space for the fixed menu */
      text-align: center;
      color: #333;
    }

    h2 {
      margin-top: 40px;
      font-size: 24px;
    }

    p {
      font-size: 16px;
      margin: 10px 0 30px;
    }

    /* CTA Install Bar (Mobile Only) */
    #cta-install-bar {
      display: none;
    }

    @media (max-width: 600px) {
      #cta-install-bar {
        display: block;
        position: fixed;
        bottom: 0;
        width: 100%;
        background: #ff9800;
        color: white;
        text-align: center;
        padding: 12px 10px;
        font-size: 14px;
        z-index: 9999;
        box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      }

      .cta-message {
        font-size: 13px;
        margin-bottom: 10px;
      }

      .cta-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: center;
      }

      .cta-buttons button,
      .cta-buttons a {
        background: white;
        color: #ff6600;
        border: none;
        border-radius: 30px;
        padding: 10px 16px;
        font-size: 14px;
        font-weight: bold;
        flex: 1 1 45%;
        max-width: 160px;
        min-width: 120px;
        text-align: center;
        text-decoration: none;
        transition: all 0.2s ease;
      }

      .cta-buttons button:hover,
      .cta-buttons a:hover {
        background: #003893;
        color: white;
      }

      .cta-buttons .close-btn {
        background: transparent;
        border: 1px solid white;
        color: white;
        flex: 1 1 100%;
      }
    }
  </style>
</head>
<body>

  <h2>üòï El pago fue cancelado</h2>
  <p>Int√©ntalo de nuevo cuando est√©s listo.</p>

  <!-- CTA Footer -->
  <div id="cta-install-bar">
    <div class="cta-message">
      ¬øQuieres acceder m√°s r√°pido? <strong>Instala AutoCuidado Club</strong> en tu celular.
    </div>
    <div class="cta-buttons">
      <button onclick="openFeedbackModal()">üìù Opini√≥n</button>
      <a href="contacto.html">üìû Contactar</a>
      <button id="how-to-install-btn">üß≠ Instalar</button>
      <button onclick="document.getElementById('cta-install-bar').style.display='none'" class="close-btn">‚ùå Cerrar</button>
    </div>
  </div>

  <!-- Feedback Modal -->
  <div id="feedbackModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); z-index:9999; align-items:center; justify-content:center;">
    <div style="background:white; padding:20px; border-radius:10px; width:90%; max-width:400px; position:relative;">
      <h3 style="margin-top:0;">Tu opini√≥n sobre AutoCuidado Club</h3>
      <form id="voiceFeedbackForm">
        <input type="hidden" name="_subject" value="Feedback (Fase Family & Friends) - AutoCuidado Club">
        <input type="hidden" name="_cc" value="info@autocuidadoclub.com">
        <textarea id="feedbackText" name="message" rows="5" placeholder="Habla o escribe tu mensaje..." style="width:100%; margin-bottom:10px; resize:vertical;" required></textarea>
        <input type="email" name="email" placeholder="Tu correo (opcional)" style="width:100%; margin-bottom:10px;">
        <div style="display:flex; justify-content:space-between;">
          <button type="button" onclick="startVoiceInput()">üé§ Hablar</button>
          <button type="submit">Enviar</button>
        </div>
      </form>
      <button onclick="closeFeedbackModal()" style="position:absolute; top:10px; right:10px; background:none; border:none; font-size:20px;">‚ùå</button>
      <div id="feedbackLoader" style="display:none; margin-top:10px; text-align:center;">
        <img src="loading.gif" alt="Cargando..." style="width:80px;">
      </div>
    </div>
  </div>

  <script>
    const installBtn = document.getElementById('how-to-install-btn');
    installBtn.addEventListener('click', () => {
      const isIos = /iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase());
      const isAndroid = /android/.test(navigator.userAgent.toLowerCase());
      if (isIos) {
        alert("En iPhone, toca el bot√≥n de compartir en Safari y selecciona 'Agregar a pantalla de inicio'.");
      } else if (isAndroid) {
        alert("En Android, abre el men√∫ de Chrome (‚ãÆ) y selecciona 'Agregar a pantalla de inicio'.");
      } else {
        alert("Instalaci√≥n no disponible en este dispositivo.");
      }
    });

    function openFeedbackModal() {
      document.getElementById('feedbackModal').style.display = 'flex';
      document.getElementById('feedbackText').focus();
    }

    function closeFeedbackModal() {
      document.getElementById('feedbackModal').style.display = 'none';
      document.getElementById('voiceFeedbackForm').reset();
      document.getElementById('feedbackLoader').style.display = 'none';
    }

    function startVoiceInput() {
      if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
        alert("Tu navegador no soporta reconocimiento de voz.");
        return;
      }

      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'es-ES';

      const feedbackText = document.getElementById('feedbackText');
      feedbackText.placeholder = "üéôÔ∏è Escuchando...";
      feedbackText.style.border = "2px solid orange";

      recognition.onresult = (event) => {
        const result = event.results[0][0].transcript;
        feedbackText.value += (feedbackText.value ? ' ' : '') + result;
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
      };

      recognition.onerror = (event) => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
        alert("Error de voz: " + event.error);
      };

      recognition.onend = () => {
        feedbackText.placeholder = "Habla o escribe tu mensaje...";
        feedbackText.style.border = "1px solid #ccc";
      };

      recognition.start();
    }

    document.getElementById('voiceFeedbackForm').onsubmit = function (e) {
      e.preventDefault();
      document.getElementById('feedbackLoader').style.display = 'block';

      fetch("https://formsubmit.co/ajax/info@autocuidadoclub.com", {
        method: "POST",
        body: new FormData(this)
      })
      .then(res => res.json())
      .then(data => {
        document.getElementById('feedbackLoader').style.display = 'none';
        if (data.success) {
          alert("¬°Gracias por tu opini√≥n!");
          closeFeedbackModal();
        } else {
          alert("Error al enviar. Intenta de nuevo.");
        }
      })
      .catch(() => {
        document.getElementById('feedbackLoader').style.display = 'none';
        alert("Hubo un problema al enviar el mensaje.");
      });
    };
  </script>

</body>
</html>
